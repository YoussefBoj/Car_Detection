================================================================================
CODE EXTRACTION FROM: C:\Users\youss\Downloads\Documents\Stages+Projects\Projects 2 eme\p2m_modified2
Total files extracted: 33
================================================================================


================================================================================
FILE: p2m/.env.example
================================================================================
[SENSITIVE FILE - CONTENT NOT DISPLAYED FOR SECURITY]
This file may contain passwords, API keys, or credentials.


================================================================================
FILE: p2m/.eslintrc.json
================================================================================
{
  "extends": ["next/core-web-vitals", "next/typescript"]
}


================================================================================
FILE: p2m/app/analysis/page.tsx
================================================================================
"use client"

import { useState, useEffect } from "react"
import { motion, AnimatePresence } from "framer-motion"
import { Upload, Target, Brain, CheckCircle, User, Home } from "lucide-react"
import { Button } from "@/components/ui/button"
import { useAuth } from "@/hooks/use-auth"
import { useRouter } from "next/navigation"
import UploadStep from "@/components/upload-step"
import AICheckStep from "@/components/ai-check-step"
import DetectionChoiceStep from "@/components/detection-choice-step"
import ResultsStep from "@/components/results-step"

const steps = [
  { id: "upload", title: "Upload Image", icon: Upload },
  { id: "ai-check", title: "AI Verification", icon: Brain },
  { id: "detection", title: "Detection Method", icon: Target },
  { id: "results", title: "Results", icon: CheckCircle },
]

export default function AnalysisPage() {
  const [currentStep, setCurrentStep] = useState("upload")
  const [uploadedImage, setUploadedImage] = useState<File | null>(null)
  const [aiCheckResult, setAiCheckResult] = useState<any>(null)
  const [detectionMethod, setDetectionMethod] = useState<string | null>(null)
  const [analysisResults, setAnalysisResults] = useState<any>(null)

  const { user } = useAuth()
  const router = useRouter()

  useEffect(() => {
    if (!user) {
      router.push("/auth")
    }
  }, [user, router])

  const getCurrentStepIndex = () => {
    return steps.findIndex((step) => step.id === currentStep)
  }

  const goToNextStep = () => {
    const currentIndex = getCurrentStepIndex()
    if (currentIndex < steps.length - 1) {
      setCurrentStep(steps[currentIndex + 1].id)
    }
  }

  const goToPreviousStep = () => {
    const currentIndex = getCurrentStepIndex()
    if (currentIndex > 0) {
      setCurrentStep(steps[currentIndex - 1].id)
    }
  }

  const resetAnalysis = () => {
    setCurrentStep("upload")
    setUploadedImage(null)
    setAiCheckResult(null)
    setDetectionMethod(null)
    setAnalysisResults(null)
  }

  if (!user) {
    return null
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900">
      {/* Header */}
      <div className="bg-black/20 backdrop-blur-lg border-b border-white/10">
        <div className="max-w-7xl mx-auto px-4 py-6">
          <div className="flex items-center justify-between">
            <div>
              <h1 className="text-3xl font-bold text-white">Analysis Dashboard</h1>
              <p className="text-gray-300">Welcome back, {user.username}!</p>
            </div>
            <div className="flex items-center space-x-4">
              <Button
                onClick={() => router.push("/dashboard")}
                className="bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
              >
                <User className="w-4 h-4 mr-2" />
                Dashboard
              </Button>
              <Button
                onClick={() => router.push("/")}
                className="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
              >
                <Home className="w-4 h-4 mr-2" />
                Home
              </Button>
            </div>
          </div>
        </div>
      </div>

      {/* Progress Steps */}
      <div className="max-w-4xl mx-auto px-4 py-8">
        <div className="flex items-center justify-between mb-12">
          {steps.map((step, index) => {
            const isActive = step.id === currentStep
            const isCompleted = getCurrentStepIndex() > index
            const StepIcon = step.icon

            return (
              <div key={step.id} className="flex items-center">
                <motion.div
                  initial={{ scale: 0.8, opacity: 0.5 }}
                  animate={{
                    scale: isActive ? 1.1 : 1,
                    opacity: isActive || isCompleted ? 1 : 0.5,
                  }}
                  transition={{ duration: 0.3 }}
                  className={`flex items-center justify-center w-12 h-12 rounded-full border-2 ${
                    isCompleted
                      ? "bg-green-500 border-green-500"
                      : isActive
                        ? "bg-cyan-500 border-cyan-500"
                        : "bg-white/10 border-white/20"
                  }`}
                >
                  {isCompleted ? (
                    <CheckCircle className="w-6 h-6 text-white" />
                  ) : (
                    <StepIcon className="w-6 h-6 text-white" />
                  )}
                </motion.div>

                <div className="ml-3">
                  <p className={`text-sm font-medium ${isActive || isCompleted ? "text-white" : "text-gray-400"}`}>
                    {step.title}
                  </p>
                </div>

                {index < steps.length - 1 && (
                  <div className={`w-16 h-0.5 mx-4 ${isCompleted ? "bg-green-500" : "bg-white/20"}`} />
                )}
              </div>
            )
          })}
        </div>

        {/* Step Content */}
        <AnimatePresence mode="wait">
          <motion.div
            key={currentStep}
            initial={{ opacity: 0, x: 20 }}
            animate={{ opacity: 1, x: 0 }}
            exit={{ opacity: 0, x: -20 }}
            transition={{ duration: 0.3 }}
          >
            {currentStep === "upload" && (
              <UploadStep uploadedImage={uploadedImage} setUploadedImage={setUploadedImage} onNext={goToNextStep} />
            )}

            {currentStep === "ai-check" && (
              <AICheckStep
                uploadedImage={uploadedImage}
                aiCheckResult={aiCheckResult}
                setAiCheckResult={setAiCheckResult}
                onNext={goToNextStep}
                onBack={goToPreviousStep}
              />
            )}

            {currentStep === "detection" && (
              <DetectionChoiceStep
                detectionMethod={detectionMethod}
                setDetectionMethod={setDetectionMethod}
                onNext={goToNextStep}
                onBack={goToPreviousStep}
              />
            )}

            {currentStep === "results" && (
              <ResultsStep
                uploadedImage={uploadedImage}
                detectionMethod={detectionMethod}
                analysisResults={analysisResults}
                setAnalysisResults={setAnalysisResults}
                onReset={resetAnalysis}
                onBack={goToPreviousStep}
              />
            )}
          </motion.div>
        </AnimatePresence>
      </div>
    </div>
  )
}


================================================================================
FILE: p2m/app/api/ai-check/route.ts
================================================================================
import { type NextRequest, NextResponse } from "next/server"

export async function POST(request: NextRequest) {
  try {
    const formData = await request.formData()
    const file = formData.get("image") as File

    if (!file) {
      return NextResponse.json({ error: "No image provided" }, { status: 400 })
    }

    // Check if we have an AI service URL configured
    const aiServiceUrl = process.env.AI_SERVICE_URL

    // If we're in a preview environment or AI service isn't configured,
    // return a mock response instead of trying to call the actual service
    if (!aiServiceUrl) {
      console.log("AI service URL not configured, using mock response")

      // Wait a bit to simulate processing time
      await new Promise((resolve) => setTimeout(resolve, 1500))

      // Return mock response
      return NextResponse.json({
        isAI: Math.random() > 0.8, // 20% chance of being flagged as AI
        confidence: Math.random() * 0.2 + 0.8, // 80-100% confidence
        processing_time: 1.2,
      })
    }

    // Convert file to base64 for processing
    const bytes = await file.arrayBuffer()
    const buffer = Buffer.from(bytes)
    const base64Image = buffer.toString("base64")

    try {
      // Call Python AI detection service
      const response = await fetch(`${aiServiceUrl}/ai-check`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          image: base64Image,
          model_path: "models/gnet.h5",
        }),
      })

      if (!response.ok) {
        throw new Error(`AI service responded with status: ${response.status}`)
      }

      const result = await response.json()

      return NextResponse.json({
        isAI: result.is_ai_generated,
        confidence: result.confidence,
        processing_time: result.processing_time,
      })
    } catch (serviceError) {
      console.error("AI service error:", serviceError)

      // If the service call fails, fall back to mock response
      return NextResponse.json({
        isAI: Math.random() > 0.8,
        confidence: Math.random() * 0.2 + 0.8,
        processing_time: 1.2,
        note: "Using mock data due to service unavailability",
      })
    }
  } catch (error) {
    console.error("AI check error:", error)
    return NextResponse.json({ error: "Failed to process AI detection" }, { status: 500 })
  }
}


================================================================================
FILE: p2m/app/api/cost-estimation/route.ts
================================================================================
import { type NextRequest, NextResponse } from "next/server"

// Cost estimation based on damage type and vehicle brand
const COST_DATABASE = {
  brands: {
    BMW: { multiplier: 1.8, base_cost: 500 },
    Mercedes: { multiplier: 1.9, base_cost: 550 },
    Audi: { multiplier: 1.7, base_cost: 480 },
    Toyota: { multiplier: 1.2, base_cost: 300 },
    Honda: { multiplier: 1.1, base_cost: 280 },
    Volkswagen: { multiplier: 1.4, base_cost: 350 },
    Ford: { multiplier: 1.3, base_cost: 320 },
    Peugeot: { multiplier: 1.2, base_cost: 290 },
    Renault: { multiplier: 1.1, base_cost: 270 },
    Hyundai: { multiplier: 1.0, base_cost: 250 },
    Unknown: { multiplier: 1.2, base_cost: 300 },
  },
  damage_types: {
    dent: { cost: 400, severity_multiplier: { minor: 0.5, moderate: 1.0, severe: 1.8 } },
    scratch: { cost: 200, severity_multiplier: { minor: 0.3, moderate: 0.8, severe: 1.5 } },
    crack: { cost: 600, severity_multiplier: { minor: 0.6, moderate: 1.2, severe: 2.0 } },
    broken_light: { cost: 350, severity_multiplier: { minor: 0.8, moderate: 1.0, severe: 1.3 } },
    bumper_damage: { cost: 800, severity_multiplier: { minor: 0.7, moderate: 1.0, severe: 1.6 } },
    door_damage: { cost: 1200, severity_multiplier: { minor: 0.6, moderate: 1.0, severe: 1.8 } },
    windshield_damage: { cost: 500, severity_multiplier: { minor: 0.8, moderate: 1.0, severe: 1.4 } },
  },
}

export async function POST(request: NextRequest) {
  try {
    const { detections, brand } = await request.json()

    if (!detections || !Array.isArray(detections)) {
      return NextResponse.json({ error: "Invalid detections data" }, { status: 400 })
    }

    let totalCost = 0
    const brandInfo = COST_DATABASE.brands[brand] || COST_DATABASE.brands["Unknown"]

    // Calculate cost for each detected damage
    const costBreakdown = detections.map((detection: any) => {
      const damageType = detection.class.toLowerCase().replace(" ", "_")
      const severity = detection.confidence > 0.8 ? "severe" : detection.confidence > 0.6 ? "moderate" : "minor"

      const damageInfo = COST_DATABASE.damage_types[damageType] || COST_DATABASE.damage_types["dent"]

      const baseCost = damageInfo.cost
      const severityMultiplier = damageInfo.severity_multiplier[severity]
      const brandMultiplier = brandInfo.multiplier

      const itemCost = Math.round(baseCost * severityMultiplier * brandMultiplier + brandInfo.base_cost)

      totalCost += itemCost

      return {
        damage_type: detection.class,
        severity: severity,
        confidence: detection.confidence,
        cost: itemCost,
        location: detection.bbox,
      }
    })

    // Add labor costs (30% of parts cost)
    const laborCost = Math.round(totalCost * 0.3)
    const finalCost = totalCost + laborCost

    return NextResponse.json({
      total_cost: finalCost,
      parts_cost: totalCost,
      labor_cost: laborCost,
      brand: brand,
      breakdown: costBreakdown,
      currency: "DT",
    })
  } catch (error) {
    console.error("Cost estimation error:", error)
    return NextResponse.json({ error: "Failed to calculate cost estimation" }, { status: 500 })
  }
}


================================================================================
FILE: p2m/app/api/damage-detection/route.ts
================================================================================
import { type NextRequest, NextResponse } from "next/server"

export async function POST(request: NextRequest) {
  try {
    const formData = await request.formData()
    const file = formData.get("image") as File
    const method = formData.get("method") as string

    if (!file) {
      return NextResponse.json({ error: "No image provided" }, { status: 400 })
    }

    if (!method || !["yolo", "roboflow"].includes(method)) {
      return NextResponse.json({ error: "Invalid detection method" }, { status: 400 })
    }

    // Check if we have an AI service URL configured
    const aiServiceUrl = process.env.AI_SERVICE_URL

    // If we're in a preview environment or AI service isn't configured,
    // return a mock response instead of trying to call the actual service
    if (!aiServiceUrl) {
      console.log("AI service URL not configured, using mock response")

      // Wait a bit to simulate processing time
      await new Promise((resolve) => setTimeout(resolve, 2000))

      // Generate mock detections
      const mockDetections = [
        {
          class: "dent",
          confidence: 0.92,
          bbox: [120, 80, 200, 150],
        },
        {
          class: "scratch",
          confidence: 0.87,
          bbox: [300, 200, 450, 280],
        },
      ]

      // Return mock response
      return NextResponse.json({
        detections: mockDetections,
        confidence: 0.895,
        processing_time: 1.8,
        annotated_image: null,
        method: method,
        brand: "BMW",
        damage_types: ["dent", "scratch"],
        severity: "moderate",
      })
    }

    // Convert file to base64 for processing
    const bytes = await file.arrayBuffer()
    const buffer = Buffer.from(bytes)
    const base64Image = buffer.toString("base64")

    try {
      // Call complete analysis endpoint
      const response = await fetch(`${aiServiceUrl}/complete-analysis`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          image: base64Image,
          method: method,
        }),
      })

      if (!response.ok) {
        throw new Error(`Analysis service responded with status: ${response.status}`)
      }

      const result = await response.json()

      // Check if AI-generated image was detected
      if (result.error && result.error.includes("AI-generated")) {
        return NextResponse.json(
          {
            error: "AI-generated image detected",
            ai_check: result.ai_check,
          },
          { status: 400 },
        )
      }

      return NextResponse.json({
        detections: result.detection.detections,
        confidence: result.detection.confidence,
        processing_time: result.total_processing_time,
        annotated_image: result.detection.annotated_image,
        method: method,
        brand: result.brand.brand,
        brand_confidence: result.brand.confidence,
        damage_types: result.damage_types.damage_types,
        severity: result.severity.severity,
        severity_confidence: result.severity.confidence,
      })
    } catch (serviceError) {
      console.error("Detection service error:", serviceError)

      // If the service call fails, fall back to mock response
      const mockDetections = [
        {
          class: "dent",
          confidence: 0.92,
          bbox: [120, 80, 200, 150],
        },
        {
          class: "scratch",
          confidence: 0.87,
          bbox: [300, 200, 450, 280],
        },
      ]

      return NextResponse.json({
        detections: mockDetections,
        confidence: 0.895,
        processing_time: 1.8,
        annotated_image: null,
        method: method,
        brand: "BMW",
        damage_types: ["dent", "scratch"],
        severity: "moderate",
        note: "Using mock data due to service unavailability",
      })
    }
  } catch (error) {
    console.error("Damage detection error:", error)
    return NextResponse.json({ error: "Failed to process damage detection" }, { status: 500 })
  }
}


================================================================================
FILE: p2m/app/auth/page.tsx
================================================================================
"use client"

import type React from "react"

import { useState } from "react"
import { motion } from "framer-motion"
import { Eye, EyeOff, Car, ArrowLeft } from "lucide-react"
import { Button } from "@/components/ui/button"
import { Card, CardContent } from "@/components/ui/card"
import { Input } from "@/components/ui/input"
import { Label } from "@/components/ui/label"
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs"
import Link from "next/link"
import { useAuth } from "@/hooks/use-auth"
import { useRouter } from "next/navigation"

export default function AuthPage() {
  const [showPassword, setShowPassword] = useState(false)
  const [showConfirmPassword, setShowConfirmPassword] = useState(false)
  const [isLoading, setIsLoading] = useState(false)
  const { login, register } = useAuth()
  const router = useRouter()

  const [loginData, setLoginData] = useState({
    username: "",
    password: "",
    rememberMe: false,
  })

  const [registerData, setRegisterData] = useState({
    username: "",
    email: "",
    password: "",
    confirmPassword: "",
    dateOfBirth: "",
    cinNumber: "",
    phoneNumber: "",
  })

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault()
    setIsLoading(true)

    try {
      await login(loginData.username, loginData.password, loginData.rememberMe)
      router.push("/analysis")
    } catch (error) {
      console.error("Login failed:", error)
    } finally {
      setIsLoading(false)
    }
  }

  const handleRegister = async (e: React.FormEvent) => {
    e.preventDefault()
    setIsLoading(true)

    try {
      await register(registerData)
      router.push("/analysis")
    } catch (error) {
      console.error("Registration failed:", error)
    } finally {
      setIsLoading(false)
    }
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4">
      {/* Background Elements */}
      <div className="absolute inset-0 overflow-hidden">
        <motion.div
          animate={{
            scale: [1, 1.2, 1],
            opacity: [0.3, 0.6, 0.3],
          }}
          transition={{
            duration: 8,
            repeat: Number.POSITIVE_INFINITY,
            ease: "easeInOut",
          }}
          className="absolute top-1/4 left-1/4 w-96 h-96 bg-cyan-500/20 rounded-full blur-3xl"
        />
        <motion.div
          animate={{
            scale: [1.2, 1, 1.2],
            opacity: [0.2, 0.5, 0.2],
          }}
          transition={{
            duration: 10,
            repeat: Number.POSITIVE_INFINITY,
            ease: "easeInOut",
          }}
          className="absolute bottom-1/4 right-1/4 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl"
        />
      </div>

      <div className="relative z-10 w-full max-w-md">
        {/* Back Button */}
        <motion.div
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.6 }}
          className="mb-6"
        >
          <Link href="/">
            <Button className="bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
              <ArrowLeft className="w-4 h-4 mr-2" />
              Back to Home
            </Button>
          </Link>
        </motion.div>

        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.6 }}>
          <Card className="bg-white/10 backdrop-blur-lg border-white/20">
            <CardContent className="p-8">
              {/* Logo */}
              <div className="text-center mb-8">
                <motion.div
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  transition={{ duration: 0.6, delay: 0.2 }}
                  className="flex items-center justify-center mb-4"
                >
                  <Car className="w-12 h-12 text-cyan-400" />
                </motion.div>
                <h1 className="text-3xl font-bold text-white mb-2">Welcome to AI AutoExpert</h1>
                <p className="text-gray-300">Your intelligent vehicle damage assessment platform</p>
              </div>

              <Tabs defaultValue="login" className="w-full">
                <TabsList className="grid w-full grid-cols-2 bg-white/10">
                  <TabsTrigger value="login" className="data-[state=active]:bg-cyan-500">
                    Login
                  </TabsTrigger>
                  <TabsTrigger value="register" className="data-[state=active]:bg-cyan-500">
                    Register
                  </TabsTrigger>
                </TabsList>

                <TabsContent value="login">
                  <motion.form
                    initial={{ opacity: 0, x: -20 }}
                    animate={{ opacity: 1, x: 0 }}
                    transition={{ duration: 0.6 }}
                    onSubmit={handleLogin}
                    className="space-y-6"
                  >
                    <div className="space-y-2">
                      <Label htmlFor="username" className="text-white">
                        Username
                      </Label>
                      <Input
                        id="username"
                        type="text"
                        placeholder="Enter your username"
                        value={loginData.username}
                        onChange={(e) => setLoginData({ ...loginData, username: e.target.value })}
                        className="bg-white/10 border-white/20 text-white placeholder-gray-400"
                        required
                      />
                    </div>

                    <div className="space-y-2">
                      <Label htmlFor="password" className="text-white">
                        Password
                      </Label>
                      <div className="relative">
                        <Input
                          id="password"
                          type={showPassword ? "text" : "password"}
                          placeholder="Enter your password"
                          value={loginData.password}
                          onChange={(e) => setLoginData({ ...loginData, password: e.target.value })}
                          className="bg-white/10 border-white/20 text-white placeholder-gray-400 pr-10"
                          required
                        />
                        <button
                          type="button"
                          onClick={() => setShowPassword(!showPassword)}
                          className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white"
                        >
                          {showPassword ? <EyeOff className="w-4 h-4" /> : <Eye className="w-4 h-4" />}
                        </button>
                      </div>
                    </div>

                    <div className="flex items-center space-x-2">
                      <input
                        type="checkbox"
                        id="remember"
                        checked={loginData.rememberMe}
                        onChange={(e) => setLoginData({ ...loginData, rememberMe: e.target.checked })}
                        className="rounded border-white/20"
                      />
                      <Label htmlFor="remember" className="text-gray-300 text-sm">
                        Remember me for 30 days
                      </Label>
                    </div>

                    <Button
                      type="submit"
                      disabled={isLoading}
                      className="w-full bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
                    >
                      {isLoading ? "Logging in..." : "Login"}
                    </Button>
                  </motion.form>
                </TabsContent>

                <TabsContent value="register">
                  <motion.form
                    initial={{ opacity: 0, x: 20 }}
                    animate={{ opacity: 1, x: 0 }}
                    transition={{ duration: 0.6 }}
                    onSubmit={handleRegister}
                    className="space-y-4"
                  >
                    <div className="grid grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="reg-username" className="text-white">
                          Username
                        </Label>
                        <Input
                          id="reg-username"
                          type="text"
                          placeholder="Choose username"
                          value={registerData.username}
                          onChange={(e) => setRegisterData({ ...registerData, username: e.target.value })}
                          className="bg-white/10 border-white/20 text-white placeholder-gray-400"
                          required
                        />
                      </div>

                      <div className="space-y-2">
                        <Label htmlFor="email" className="text-white">
                          Email
                        </Label>
                        <Input
                          id="email"
                          type="email"
                          placeholder="your@email.com"
                          value={registerData.email}
                          onChange={(e) => setRegisterData({ ...registerData, email: e.target.value })}
                          className="bg-white/10 border-white/20 text-white placeholder-gray-400"
                          required
                        />
                      </div>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="reg-password" className="text-white">
                          Password
                        </Label>
                        <div className="relative">
                          <Input
                            id="reg-password"
                            type={showPassword ? "text" : "password"}
                            placeholder="Create password"
                            value={registerData.password}
                            onChange={(e) => setRegisterData({ ...registerData, password: e.target.value })}
                            className="bg-white/10 border-white/20 text-white placeholder-gray-400 pr-10"
                            required
                          />
                          <button
                            type="button"
                            onClick={() => setShowPassword(!showPassword)}
                            className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white"
                          >
                            {showPassword ? <EyeOff className="w-4 h-4" /> : <Eye className="w-4 h-4" />}
                          </button>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <Label htmlFor="confirm-password" className="text-white">
                          Confirm Password
                        </Label>
                        <div className="relative">
                          <Input
                            id="confirm-password"
                            type={showConfirmPassword ? "text" : "password"}
                            placeholder="Confirm password"
                            value={registerData.confirmPassword}
                            onChange={(e) => setRegisterData({ ...registerData, confirmPassword: e.target.value })}
                            className="bg-white/10 border-white/20 text-white placeholder-gray-400 pr-10"
                            required
                          />
                          <button
                            type="button"
                            onClick={() => setShowConfirmPassword(!showConfirmPassword)}
                            className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white"
                          >
                            {showConfirmPassword ? <EyeOff className="w-4 h-4" /> : <Eye className="w-4 h-4" />}
                          </button>
                        </div>
                      </div>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="dob" className="text-white">
                          Date of Birth
                        </Label>
                        <Input
                          id="dob"
                          type="date"
                          value={registerData.dateOfBirth}
                          onChange={(e) => setRegisterData({ ...registerData, dateOfBirth: e.target.value })}
                          className="bg-white/10 border-white/20 text-white"
                          required
                        />
                      </div>

                      <div className="space-y-2">
                        <Label htmlFor="cin" className="text-white">
                          CIN Number
                        </Label>
                        <Input
                          id="cin"
                          type="text"
                          placeholder="12345678"
                          maxLength={8}
                          value={registerData.cinNumber}
                          onChange={(e) => setRegisterData({ ...registerData, cinNumber: e.target.value })}
                          className="bg-white/10 border-white/20 text-white placeholder-gray-400"
                          required
                        />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label htmlFor="phone" className="text-white">
                        Phone Number
                      </Label>
                      <Input
                        id="phone"
                        type="tel"
                        placeholder="+216 XX XXX XXX"
                        value={registerData.phoneNumber}
                        onChange={(e) => setRegisterData({ ...registerData, phoneNumber: e.target.value })}
                        className="bg-white/10 border-white/20 text-white placeholder-gray-400"
                        required
                      />
                    </div>

                    <Button
                      type="submit"
                      disabled={isLoading}
                      className="w-full bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
                    >
                      {isLoading ? "Creating Account..." : "Create Account"}
                    </Button>
                  </motion.form>
                </TabsContent>
              </Tabs>
            </CardContent>
          </Card>
        </motion.div>
      </div>
    </div>
  )
}


================================================================================
FILE: p2m/app/dashboard/page.tsx
================================================================================
"use client"

import { useEffect } from "react"
import { motion } from "framer-motion"
import { Calendar, Phone, Mail, CreditCard, BarChart3, History, ArrowLeft } from "lucide-react"
import { Button } from "@/components/ui/button"
import { Card, CardContent } from "@/components/ui/card"
import { useAuth } from "@/hooks/use-auth"
import { useRouter } from "next/navigation"
import Link from "next/link"

export default function DashboardPage() {
  const { user, logout } = useAuth()
  const router = useRouter()

  useEffect(() => {
    if (!user) {
      router.push("/auth")
    }
  }, [user, router])

  if (!user) {
    return null
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900">
      {/* Header */}
      <div className="bg-black/20 backdrop-blur-lg border-b border-white/10">
        <div className="max-w-7xl mx-auto px-4 py-6">
          <div className="flex items-center justify-between">
            <div>
              <h1 className="text-3xl font-bold text-white">User Dashboard</h1>
              <p className="text-gray-300">Manage your profile and view analysis history</p>
            </div>
            <div className="flex items-center space-x-4">
              <Link href="/analysis">
                <Button className="bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                  New Analysis
                </Button>
              </Link>
              <Link href="/">
                <Button className="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                  <ArrowLeft className="w-4 h-4 mr-2" />
                  Home
                </Button>
              </Link>
            </div>
          </div>
        </div>
      </div>

      <div className="max-w-7xl mx-auto px-4 py-8">
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          {/* Profile Section */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.6 }}
            className="lg:col-span-1"
          >
            <Card className="bg-white/10 backdrop-blur-lg border-white/20">
              <CardContent className="p-8 text-center">
                <div className="w-24 h-24 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-6">
                  <span className="text-3xl font-bold text-white">{user.username[0].toUpperCase()}</span>
                </div>

                <h2 className="text-2xl font-bold text-white mb-2">{user.username}</h2>
                <p className="text-gray-300 mb-6">Premium Member</p>

                <div className="space-y-4 text-left">
                  <div className="flex items-center space-x-3">
                    <Mail className="w-5 h-5 text-cyan-400" />
                    <span className="text-gray-300">{user.email}</span>
                  </div>
                  <div className="flex items-center space-x-3">
                    <Phone className="w-5 h-5 text-cyan-400" />
                    <span className="text-gray-300">{user.phoneNumber}</span>
                  </div>
                  <div className="flex items-center space-x-3">
                    <CreditCard className="w-5 h-5 text-cyan-400" />
                    <span className="text-gray-300">CIN: {user.cinNumber}</span>
                  </div>
                  <div className="flex items-center space-x-3">
                    <Calendar className="w-5 h-5 text-cyan-400" />
                    <span className="text-gray-300">Born: {user.dateOfBirth}</span>
                  </div>
                </div>

                <div className="mt-8 pt-6 border-t border-white/10">
                  <div className="flex justify-between items-center mb-4">
                    <span className="text-gray-300">Member since</span>
                    <span className="text-white font-semibold">{new Date(user.createdAt).toLocaleDateString()}</span>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-gray-300">Analyses performed</span>
                    <span className="text-cyan-400 font-bold text-xl">{user.analysesCount}</span>
                  </div>
                </div>

                <Button
                  onClick={logout}
                  className="w-full mt-6 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
                >
                  Logout
                </Button>
              </CardContent>
            </Card>
          </motion.div>

          {/* Analysis History */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.6, delay: 0.2 }}
            className="lg:col-span-2"
          >
            <Card className="bg-white/10 backdrop-blur-lg border-white/20">
              <CardContent className="p-8">
                <div className="flex items-center justify-between mb-6">
                  <h3 className="text-2xl font-bold text-white flex items-center">
                    <History className="w-6 h-6 mr-3 text-cyan-400" />
                    Recent Analysis History
                  </h3>
                  <BarChart3 className="w-6 h-6 text-purple-400" />
                </div>

                {user.analysisHistory && user.analysisHistory.length > 0 ? (
                  <div className="space-y-4">
                    {user.analysisHistory
                      .slice(-5)
                      .reverse()
                      .map((analysis, index) => (
                        <motion.div
                          key={index}
                          initial={{ opacity: 0, x: -20 }}
                          animate={{ opacity: 1, x: 0 }}
                          transition={{ duration: 0.3, delay: index * 0.1 }}
                          className="bg-white/5 rounded-lg p-4 border border-white/10 hover:bg-white/10 transition-all duration-300"
                        >
                          <div className="flex justify-between items-start mb-2">
                            <div className="flex items-center space-x-2">
                              <div className="w-3 h-3 bg-cyan-400 rounded-full"></div>
                              <span className="text-cyan-300 font-semibold">
                                {new Date(analysis.date).toLocaleDateString()}
                              </span>
                            </div>
                            <span className="text-green-400 font-bold">{analysis.cost} DT</span>
                          </div>

                          <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                            <div>
                              <span className="text-gray-400">Vehicle:</span>
                              <p className="text-white font-medium">{analysis.brand}</p>
                            </div>
                            <div>
                              <span className="text-gray-400">Damage:</span>
                              <p className="text-white font-medium">{analysis.damage}</p>
                            </div>
                            <div>
                              <span className="text-gray-400">Severity:</span>
                              <p className="text-white font-medium">{analysis.severity}</p>
                            </div>
                            <div>
                              <span className="text-gray-400">Time:</span>
                              <p className="text-white font-medium">
                                {new Date(analysis.date).toLocaleTimeString([], {
                                  hour: "2-digit",
                                  minute: "2-digit",
                                })}
                              </p>
                            </div>
                          </div>
                        </motion.div>
                      ))}
                  </div>
                ) : (
                  <div className="text-center py-12">
                    <BarChart3 className="w-16 h-16 text-gray-600 mx-auto mb-4" />
                    <h4 className="text-xl font-semibold text-gray-400 mb-2">No Analysis History</h4>
                    <p className="text-gray-500 mb-6">Start analyzing your vehicle images to see your history here!</p>
                    <Link href="/analysis">
                      <Button className="bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                        Start Your First Analysis
                      </Button>
                    </Link>
                  </div>
                )}
              </CardContent>
            </Card>
          </motion.div>
        </div>
      </div>
    </div>
  )
}


================================================================================
FILE: p2m/app/layout.tsx
================================================================================
import type React from "react"
import { Inter } from "next/font/google"
import "./globals.css"
import { AuthProvider } from "@/hooks/use-auth"

const inter = Inter({ subsets: ["latin"] })

function ClientLayout({ children }: { children: React.ReactNode }) {
  return <AuthProvider>{children}</AuthProvider>
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body className={inter.className}>
        <ClientLayout>{children}</ClientLayout>
      </body>
    </html>
  )
}


================================================================================
FILE: p2m/app/page.tsx
================================================================================
"use client"

import { useState, useEffect } from "react"
import { motion } from "framer-motion"
import { Car, Shield, Zap, Users, Phone, MapPin, Clock } from "lucide-react"
import { Button } from "@/components/ui/button"
import { Card, CardContent } from "@/components/ui/card"
import Navbar from "@/components/navbar"
import HeroSection from "@/components/hero-section"
import GarageCarousel from "@/components/garage-carousel"
import NewsSection from "@/components/news-section"

const stats = [
  { number: "99%", label: "Accuracy Rate", icon: Shield },
  { number: "10K+", label: "Claims Processed", icon: Users },
  { number: "24/7", label: "Available", icon: Clock },
  { number: "5sec", label: "Average Analysis Time", icon: Zap },
]

const services = [
  {
    icon: Car,
    title: "FULL CAR ASSESSMENT",
    description: "Complete vehicle damage assessment with detailed reporting and insurance claim estimation",
    gradient: "from-purple-600 to-blue-600",
  },
  {
    icon: Shield,
    title: "DETAILED PART DETECTION",
    description: "Precise identification of specific damaged components using advanced AI algorithms",
    gradient: "from-blue-600 to-cyan-600",
  },
  {
    icon: Zap,
    title: "INSURANCE COST ESTIMATION",
    description: "Accurate repair cost calculations based on vehicle type and damage severity for claims",
    gradient: "from-cyan-600 to-teal-600",
  },
]

export default function HomePage() {
  const [mounted, setMounted] = useState(false)

  useEffect(() => {
    setMounted(true)
  }, [])

  if (!mounted) return null

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900">
      <Navbar />

      {/* Hero Section */}
      <HeroSection />

      {/* Stats Section */}
      <section className="py-20 px-4">
        <div className="max-w-7xl mx-auto">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.6 }}
            viewport={{ once: true }}
            className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"
          >
            {stats.map((stat, index) => (
              <motion.div
                key={stat.label}
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                transition={{ duration: 0.6, delay: index * 0.1 }}
                viewport={{ once: true }}
                whileHover={{ scale: 1.05 }}
                className="text-center"
              >
                <Card className="bg-white/10 backdrop-blur-lg border-white/20 hover:bg-white/15 transition-all duration-300">
                  <CardContent className="p-8">
                    <stat.icon className="w-12 h-12 mx-auto mb-4 text-cyan-400" />
                    <div className="text-4xl font-bold text-white mb-2">{stat.number}</div>
                    <div className="text-gray-300">{stat.label}</div>
                  </CardContent>
                </Card>
              </motion.div>
            ))}
          </motion.div>
        </div>
      </section>

      {/* About Section */}
      <section id="about" className="py-20 px-4">
        <div className="max-w-7xl mx-auto">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.6 }}
            viewport={{ once: true }}
            className="text-center mb-16"
          >
            <h2 className="text-5xl font-bold text-white mb-6">
              About Our{" "}
              <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-400">
                Technology
              </span>
            </h2>
            <p className="text-xl text-gray-300 max-w-3xl mx-auto">
              Revolutionary AI-powered vehicle damage assessment for the modern insurance industry
            </p>
          </motion.div>

          <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <motion.div
              initial={{ opacity: 0, x: -50 }}
              whileInView={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.6 }}
              viewport={{ once: true }}
            >
              <Card className="bg-white/10 backdrop-blur-lg border-white/20 p-8">
                <h3 className="text-2xl font-bold text-white mb-4">ü§ñ AI Detection</h3>
                <p className="text-gray-300 leading-relaxed">
                  Our advanced AI algorithms can detect whether an image is AI-generated or authentic, ensuring accurate
                  analysis of real vehicle damage for insurance claims.
                </p>
              </Card>
            </motion.div>

            <motion.div
              initial={{ opacity: 0, x: 50 }}
              whileInView={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.6, delay: 0.2 }}
              viewport={{ once: true }}
            >
              <Card className="bg-white/10 backdrop-blur-lg border-white/20 p-8">
                <h3 className="text-2xl font-bold text-white mb-4">üîç Damage Assessment</h3>
                <p className="text-gray-300 leading-relaxed">
                  Using YOLO and Roboflow technologies, we precisely identify and locate damaged parts in vehicle images
                  with high accuracy for insurance processing.
                </p>
              </Card>
            </motion.div>
          </div>
        </div>
      </section>

      {/* Services Section */}
      <section id="services" className="py-20 px-4">
        <div className="max-w-7xl mx-auto">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.6 }}
            viewport={{ once: true }}
            className="text-center mb-16"
          >
            <h2 className="text-5xl font-bold text-white mb-6">
              Our Insurance{" "}
              <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-400">
                Services
              </span>
            </h2>
          </motion.div>

          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {services.map((service, index) => (
              <motion.div
                key={service.title}
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                transition={{ duration: 0.6, delay: index * 0.1 }}
                viewport={{ once: true }}
                whileHover={{ scale: 1.05 }}
                className="group"
              >
                <Card className="bg-white/10 backdrop-blur-lg border-white/20 hover:bg-white/15 transition-all duration-300 h-full">
                  <CardContent className="p-8 text-center">
                    <div
                      className={`w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-r ${service.gradient} flex items-center justify-center group-hover:scale-110 transition-transform duration-300`}
                    >
                      <service.icon className="w-8 h-8 text-white" />
                    </div>
                    <h3 className="text-xl font-bold text-white mb-4">{service.title}</h3>
                    <p className="text-gray-300 leading-relaxed">{service.description}</p>
                  </CardContent>
                </Card>
              </motion.div>
            ))}
          </div>
        </div>
      </section>

      {/* Garage Carousel Section */}
      <GarageCarousel />

      {/* News Section */}
      <NewsSection />

      {/* Contact Section */}
      <section id="contact" className="py-20 px-4">
        <div className="max-w-7xl mx-auto">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.6 }}
            viewport={{ once: true }}
            className="text-center mb-16"
          >
            <h2 className="text-5xl font-bold text-white mb-6">
              Contact{" "}
              <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-400">Us</span>
            </h2>
          </motion.div>

          <div className="grid grid-cols-1 lg:grid-cols-2 gap-12">
            <motion.div
              initial={{ opacity: 0, x: -50 }}
              whileInView={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.6 }}
              viewport={{ once: true }}
            >
              <Card className="bg-white/10 backdrop-blur-lg border-white/20 p-8">
                <h3 className="text-2xl font-bold text-white mb-6">Get In Touch</h3>
                <div className="space-y-4">
                  <div className="flex items-center space-x-4">
                    <Phone className="w-6 h-6 text-cyan-400" />
                    <span className="text-gray-300">+216 58 257 586</span>
                  </div>
                  <div className="flex items-center space-x-4">
                    <MapPin className="w-6 h-6 text-cyan-400" />
                    <span className="text-gray-300">Tunis, Tunisia</span>
                  </div>
                  <div className="flex items-center space-x-4">
                    <Clock className="w-6 h-6 text-cyan-400" />
                    <span className="text-gray-300">24/7 Available</span>
                  </div>
                </div>
                <div className="mt-8 space-y-4">
                  <Button className="w-full bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                    Call Now
                  </Button>
                  <Button className="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                    Email Us
                  </Button>
                </div>
              </Card>
            </motion.div>

            <motion.div
              initial={{ opacity: 0, x: 50 }}
              whileInView={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.6, delay: 0.2 }}
              viewport={{ once: true }}
            >
              <Card className="bg-white/10 backdrop-blur-lg border-white/20 p-8">
                <h3 className="text-2xl font-bold text-white mb-6">Request Analysis Service</h3>
                <div className="space-y-4">
                  <input
                    type="text"
                    placeholder="Full Name"
                    className="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-400"
                  />
                  <input
                    type="email"
                    placeholder="Email Address"
                    className="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-400"
                  />
                  <input
                    type="tel"
                    placeholder="Phone Number"
                    className="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-400"
                  />
                  <textarea
                    placeholder="Describe your vehicle damage or analysis needs"
                    rows={4}
                    className="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-400"
                  />
                  <Button className="w-full bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                    Request Service
                  </Button>
                </div>
              </Card>
            </motion.div>
          </div>
        </div>
      </section>

      {/* Footer */}
      <footer className="bg-black/50 backdrop-blur-lg border-t border-white/10 py-8">
        <div className="max-w-7xl mx-auto px-4 text-center">
          <p className="text-gray-400">
            ¬© 2024 AI AutoExpert. All rights reserved. | Developed with ‚ù§Ô∏è by Youssef Boujmil & Mohamed Amine Trabelsi
          </p>
        </div>
      </footer>
    </div>
  )
}


================================================================================
FILE: p2m/components.json
================================================================================
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "app/globals.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "iconLibrary": "lucide"
}


================================================================================
FILE: p2m/components/ai-check-step.tsx
================================================================================
"use client"

import { useState } from "react"
import { motion } from "framer-motion"
import { Brain, CheckCircle, AlertTriangle, ArrowRight, ArrowLeft, RotateCcw } from "lucide-react"
import { Button } from "@/components/ui/button"
import { Card, CardContent } from "@/components/ui/card"

interface AICheckStepProps {
  uploadedImage: File | null
  aiCheckResult: any
  setAiCheckResult: (result: any) => void
  onNext: () => void
  onBack: () => void
}

export default function AICheckStep({
  uploadedImage,
  aiCheckResult,
  setAiCheckResult,
  onNext,
  onBack,
}: AICheckStepProps) {
  const [isAnalyzing, setIsAnalyzing] = useState(false)
  const [error, setError] = useState<string | null>(null)

  const runAICheck = async () => {
    if (!uploadedImage) return

    setIsAnalyzing(true)
    setError(null)

    try {
      const formData = new FormData()
      formData.append("image", uploadedImage)

      const response = await fetch("/api/ai-check", {
        method: "POST",
        body: formData,
      })

      if (!response.ok) {
        const errorText = await response.text()
        throw new Error(`Failed to analyze image: ${errorText}`)
      }

      const result = await response.json()
      setAiCheckResult(result)
    } catch (error) {
      console.error("AI check failed:", error)
      setError("Failed to analyze image. Please try again.")

      // Fallback to mock result if API fails
      setAiCheckResult({
        isAI: false,
        confidence: 0.95,
        note: "Using fallback data due to service error",
      })
    } finally {
      setIsAnalyzing(false)
    }
  }

  const resetToUpload = () => {
    setAiCheckResult(null)
    setError(null)
    onBack()
  }

  return (
    <div className="max-w-4xl mx-auto">
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6 }}
        className="text-center mb-8"
      >
        <div className="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4">
          <Brain className="w-8 h-8 text-white" />
        </div>
        <h2 className="text-3xl font-bold text-white mb-4">AI Authenticity Verification</h2>
        <p className="text-gray-300 text-lg">Using GNet model to verify if the image is authentic or AI-generated</p>
      </motion.div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <motion.div
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.6, delay: 0.2 }}
        >
          <Card className="bg-white/10 backdrop-blur-lg border-white/20">
            <CardContent className="p-8">
              <h3 className="text-xl font-bold text-white mb-4">Image Analysis</h3>
              {uploadedImage && (
                <div className="aspect-video rounded-lg overflow-hidden mb-6">
                  <img
                    src={URL.createObjectURL(uploadedImage) || "/placeholder.svg"}
                    alt="Analyzing image"
                    className="w-full h-full object-cover"
                  />
                </div>
              )}

              {!aiCheckResult && !isAnalyzing && (
                <Button
                  onClick={runAICheck}
                  className="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600"
                >
                  <Brain className="w-4 h-4 mr-2" />
                  Check Authenticity with GNet
                </Button>
              )}

              {error && (
                <div className="bg-red-500/20 border border-red-500/30 rounded-lg p-4 mb-4">
                  <p className="text-red-300 text-center">{error}</p>
                </div>
              )}

              {isAnalyzing && (
                <div className="text-center py-8">
                  <motion.div
                    animate={{ rotate: 360 }}
                    transition={{ duration: 2, repeat: Number.POSITIVE_INFINITY, ease: "linear" }}
                    className="w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"
                  />
                  <p className="text-white font-medium">Running GNet AI detection...</p>
                  <p className="text-gray-300 text-sm mt-2">Analyzing image authenticity</p>
                </div>
              )}
            </CardContent>
          </Card>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, x: 20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.6, delay: 0.4 }}
        >
          {aiCheckResult && (
            <Card className="bg-white/10 backdrop-blur-lg border-white/20">
              <CardContent className="p-8">
                {aiCheckResult.isAI ? (
                  <div className="text-center">
                    <div className="w-16 h-16 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
                      <AlertTriangle className="w-8 h-8 text-white" />
                    </div>
                    <h3 className="text-2xl font-bold text-red-400 mb-4">AI-Generated Image Detected</h3>
                    <p className="text-gray-300 mb-4 leading-relaxed">
                      GNet model detected this image as AI-generated with {(aiCheckResult.confidence * 100).toFixed(1)}%
                      confidence.
                    </p>
                    <p className="text-gray-300 mb-6 leading-relaxed">
                      Please upload an authentic photo of your vehicle for accurate analysis.
                    </p>
                    <Button
                      onClick={resetToUpload}
                      variant="outline"
                      className="border-red-400 text-red-400 hover:bg-red-400 hover:text-white"
                    >
                      <RotateCcw className="w-4 h-4 mr-2" />
                      Upload New Image
                    </Button>
                  </div>
                ) : (
                  <div className="text-center">
                    <div className="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                      <CheckCircle className="w-8 h-8 text-white" />
                    </div>
                    <h3 className="text-2xl font-bold text-green-400 mb-4">Authentic Image Verified</h3>
                    <p className="text-gray-300 mb-4 leading-relaxed">
                      GNet model confirmed this is an authentic image with {(aiCheckResult.confidence * 100).toFixed(1)}
                      % confidence.
                    </p>
                    {aiCheckResult.note && <p className="text-yellow-300 text-sm mb-4">{aiCheckResult.note}</p>}
                    <p className="text-gray-300 mb-6 leading-relaxed">Image is ready for damage detection analysis.</p>
                    <div className="space-y-4">
                      <Button
                        onClick={onNext}
                        className="w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600"
                      >
                        Continue to Detection
                        <ArrowRight className="w-4 h-4 ml-2" />
                      </Button>
                      <Button
                        onClick={onBack}
                        className="w-full bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
                      >
                        <ArrowLeft className="w-4 h-4 mr-2" />
                        Back to Upload
                      </Button>
                    </div>
                  </div>
                )}
              </CardContent>
            </Card>
          )}
        </motion.div>
      </div>
    </div>
  )
}


================================================================================
FILE: p2m/components/detection-choice-step.tsx
================================================================================
"use client"

import { motion } from "framer-motion"
import { Target, Zap, Brain, ArrowLeft } from "lucide-react"
import { Button } from "@/components/ui/button"
import { Card, CardContent } from "@/components/ui/card"

interface DetectionChoiceStepProps {
  detectionMethod: string | null
  setDetectionMethod: (method: string) => void
  onNext: () => void
  onBack: () => void
}

export default function DetectionChoiceStep({
  detectionMethod,
  setDetectionMethod,
  onNext,
  onBack,
}: DetectionChoiceStepProps) {
  const handleMethodSelect = (method: string) => {
    setDetectionMethod(method)
    setTimeout(() => {
      onNext()
    }, 500)
  }

  return (
    <div className="max-w-4xl mx-auto">
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6 }}
        className="text-center mb-8"
      >
        <div className="w-16 h-16 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
          <Target className="w-8 h-8 text-white" />
        </div>
        <h2 className="text-3xl font-bold text-white mb-4">Choose Detection Method</h2>
        <p className="text-gray-300 text-lg">Select your preferred damage detection algorithm</p>
      </motion.div>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
        <motion.div
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.6, delay: 0.2 }}
          whileHover={{ scale: 1.02 }}
          className="cursor-pointer"
          onClick={() => handleMethodSelect("yolo")}
        >
          <Card
            className={`bg-white/10 backdrop-blur-lg border-white/20 hover:bg-white/15 transition-all duration-300 h-full ${
              detectionMethod === "yolo" ? "ring-2 ring-cyan-400" : ""
            }`}
          >
            <CardContent className="p-8 text-center">
              <div className="w-20 h-20 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-6">
                <Zap className="w-10 h-10 text-white" />
              </div>

              <h3 className="text-2xl font-bold text-white mb-4">YOLO Detection</h3>
              <p className="text-gray-300 mb-6 leading-relaxed">
                Fast and efficient object detection using YOLO (You Only Look Once) algorithm. Perfect for quick
                analysis and real-time processing.
              </p>

              <div className="space-y-2 mb-6">
                <div className="flex justify-between text-sm">
                  <span className="text-gray-400">Speed</span>
                  <div className="flex space-x-1">
                    {[...Array(5)].map((_, i) => (
                      <div key={i} className="w-2 h-2 bg-cyan-400 rounded-full" />
                    ))}
                  </div>
                </div>
                <div className="flex justify-between text-sm">
                  <span className="text-gray-400">Accuracy</span>
                  <div className="flex space-x-1">
                    {[...Array(4)].map((_, i) => (
                      <div key={i} className="w-2 h-2 bg-cyan-400 rounded-full" />
                    ))}
                    <div className="w-2 h-2 bg-gray-600 rounded-full" />
                  </div>
                </div>
              </div>

              <div className="bg-cyan-500/20 rounded-lg p-3 mb-4">
                <p className="text-cyan-300 text-sm font-medium">‚ö° Recommended for speed-focused detection</p>
              </div>

              <Button className="w-full bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600">
                Choose YOLO
              </Button>
            </CardContent>
          </Card>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, x: 20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.6, delay: 0.4 }}
          whileHover={{ scale: 1.02 }}
          className="cursor-pointer"
          onClick={() => handleMethodSelect("roboflow")}
        >
          <Card
            className={`bg-white/10 backdrop-blur-lg border-white/20 hover:bg-white/15 transition-all duration-300 h-full ${
              detectionMethod === "roboflow" ? "ring-2 ring-purple-400" : ""
            }`}
          >
            <CardContent className="p-8 text-center">
              <div className="w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-6">
                <Brain className="w-10 h-10 text-white" />
              </div>

              <h3 className="text-2xl font-bold text-white mb-4">Roboflow Detection</h3>
              <p className="text-gray-300 mb-6 leading-relaxed">
                Advanced computer vision with precise segmentation using Roboflow technology. Ideal for detailed
                analysis and high-precision requirements.
              </p>

              <div className="space-y-2 mb-6">
                <div className="flex justify-between text-sm">
                  <span className="text-gray-400">Speed</span>
                  <div className="flex space-x-1">
                    {[...Array(3)].map((_, i) => (
                      <div key={i} className="w-2 h-2 bg-purple-400 rounded-full" />
                    ))}
                    {[...Array(2)].map((_, i) => (
                      <div key={i} className="w-2 h-2 bg-gray-600 rounded-full" />
                    ))}
                  </div>
                </div>
                <div className="flex justify-between text-sm">
                  <span className="text-gray-400">Accuracy</span>
                  <div className="flex space-x-1">
                    {[...Array(5)].map((_, i) => (
                      <div key={i} className="w-2 h-2 bg-purple-400 rounded-full" />
                    ))}
                  </div>
                </div>
              </div>

              <div className="bg-purple-500/20 rounded-lg p-3 mb-4">
                <p className="text-purple-300 text-sm font-medium">üéØ Recommended for precision-focused detection</p>
              </div>

              <Button className="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600">
                Choose Roboflow
              </Button>
            </CardContent>
          </Card>
        </motion.div>
      </div>

      <div className="flex justify-center">
        <Button
          onClick={onBack}
          className="bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
        >
          <ArrowLeft className="w-4 h-4 mr-2" />
          Back to Verification
        </Button>
      </div>
    </div>
  )
}


================================================================================
FILE: p2m/components/garage-carousel.tsx
================================================================================
"use client"

import { useState, useEffect } from "react"
import { motion } from "framer-motion"
import { Star, MapPin, Phone, ChevronLeft, ChevronRight } from "lucide-react"
import { Card, CardContent } from "@/components/ui/card"
import { Button } from "@/components/ui/button"

const garages = [
  {
    id: 1,
    name: "AutoFix Pro Garage",
    rating: 4.8,
    location: "Tunis, Tunisia",
    speciality: "Luxury & Sport Cars",
    phone: "+216 71 123 456",
    distance: "2.5 km away",
    image: "/placeholder.svg?height=200&width=300",
  },
  {
    id: 2,
    name: "MechaniCar Center",
    rating: 4.6,
    location: "Ariana, Tunisia",
    speciality: "All Vehicle Types",
    phone: "+216 71 234 567",
    distance: "4.1 km away",
    image: "/placeholder.svg?height=200&width=300",
  },
  {
    id: 3,
    name: "Elite Auto Repair",
    rating: 4.9,
    location: "Sfax, Tunisia",
    speciality: "Insurance Claims",
    phone: "+216 74 345 678",
    distance: "1.8 km away",
    image: "/placeholder.svg?height=200&width=300",
  },
  {
    id: 4,
    name: "TechCar Solutions",
    rating: 4.4,
    location: "Sousse, Tunisia",
    speciality: "Modern Vehicles",
    phone: "+216 73 456 789",
    distance: "3.2 km away",
    image: "/placeholder.svg?height=200&width=300",
  },
  {
    id: 5,
    name: "Premium Auto Service",
    rating: 4.7,
    location: "Monastir, Tunisia",
    speciality: "European Cars",
    phone: "+216 73 987 654",
    distance: "5.1 km away",
    image: "/placeholder.svg?height=200&width=300",
  },
]

export default function GarageCarousel() {
  const [currentIndex, setCurrentIndex] = useState(0)
  const [isAutoPlaying, setIsAutoPlaying] = useState(true)

  useEffect(() => {
    if (!isAutoPlaying) return

    const interval = setInterval(() => {
      setCurrentIndex((prev) => (prev + 1) % garages.length)
    }, 4000)

    return () => clearInterval(interval)
  }, [isAutoPlaying])

  const nextSlide = () => {
    setCurrentIndex((prev) => (prev + 1) % garages.length)
  }

  const prevSlide = () => {
    setCurrentIndex((prev) => (prev - 1 + garages.length) % garages.length)
  }

  const getVisibleGarages = () => {
    const visible = []
    for (let i = 0; i < 3; i++) {
      const index = (currentIndex + i) % garages.length
      visible.push(garages[index])
    }
    return visible
  }

  return (
    <section className="py-20 px-4">
      <div className="max-w-7xl mx-auto">
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6 }}
          viewport={{ once: true }}
          className="text-center mb-16"
        >
          <h2 className="text-5xl font-bold text-white mb-6">
            Top Recommended{" "}
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-400">Garages</span>
          </h2>
          <p className="text-xl text-gray-300 max-w-3xl mx-auto">
            Based on your analysis results, here are the best repair centers near you
          </p>
        </motion.div>

        <div
          className="relative"
          onMouseEnter={() => setIsAutoPlaying(false)}
          onMouseLeave={() => setIsAutoPlaying(true)}
        >
          {/* Navigation Buttons */}
          <Button
            onClick={prevSlide}
            variant="outline"
            size="icon"
            className="absolute left-4 top-1/2 transform -translate-y-1/2 z-10 bg-gradient-to-r from-slate-600/80 to-slate-700/80 backdrop-blur-lg border-white/20 text-white hover:from-slate-500/90 hover:to-slate-600/90 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110"
          >
            <ChevronLeft className="w-6 h-6" />
          </Button>

          <Button
            onClick={nextSlide}
            variant="outline"
            size="icon"
            className="absolute right-4 top-1/2 transform -translate-y-1/2 z-10 bg-gradient-to-r from-slate-600/80 to-slate-700/80 backdrop-blur-lg border-white/20 text-white hover:from-slate-500/90 hover:to-slate-600/90 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110"
          >
            <ChevronRight className="w-6 h-6" />
          </Button>

          {/* Carousel Container */}
          <div className="overflow-hidden">
            <motion.div
              className="flex gap-6"
              animate={{ x: `${-currentIndex * (100 / 3)}%` }}
              transition={{ duration: 0.5, ease: "easeInOut" }}
            >
              {garages.map((garage, index) => (
                <motion.div
                  key={garage.id}
                  className="flex-shrink-0 w-full md:w-1/3"
                  whileHover={{ scale: 1.05 }}
                  transition={{ duration: 0.3 }}
                >
                  <Card className="bg-white/10 backdrop-blur-lg border-white/20 hover:bg-white/15 transition-all duration-300 h-full">
                    <CardContent className="p-6">
                      <div className="aspect-video mb-4 rounded-lg overflow-hidden">
                        <img
                          src={garage.image || "/placeholder.svg"}
                          alt={garage.name}
                          className="w-full h-full object-cover"
                        />
                      </div>

                      <h3 className="text-xl font-bold text-cyan-400 mb-2">{garage.name}</h3>

                      <div className="flex items-center mb-3">
                        <div className="flex items-center">
                          {[...Array(5)].map((_, i) => (
                            <Star
                              key={i}
                              className={`w-4 h-4 ${
                                i < Math.floor(garage.rating) ? "text-yellow-400 fill-current" : "text-gray-400"
                              }`}
                            />
                          ))}
                        </div>
                        <span className="text-yellow-400 ml-2 font-semibold">{garage.rating}/5</span>
                      </div>

                      <div className="space-y-2 mb-4">
                        <div className="flex items-center text-gray-300">
                          <MapPin className="w-4 h-4 mr-2 text-cyan-400" />
                          <span className="text-sm">{garage.location}</span>
                        </div>
                        <div className="text-gray-300 text-sm">
                          <strong>Speciality:</strong> {garage.speciality}
                        </div>
                        <div className="text-gray-300 text-sm">
                          <strong>Distance:</strong> {garage.distance}
                        </div>
                      </div>

                      <Button
                        className="w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
                        onClick={() => window.open(`tel:${garage.phone}`, "_self")}
                      >
                        <Phone className="w-4 h-4 mr-2" />
                        Call {garage.phone}
                      </Button>
                    </CardContent>
                  </Card>
                </motion.div>
              ))}
            </motion.div>
          </div>

          {/* Dots Indicator */}
          <div className="flex justify-center mt-8 space-x-2">
            {garages.map((_, index) => (
              <button
                key={index}
                onClick={() => setCurrentIndex(index)}
                className={`w-3 h-3 rounded-full transition-all duration-300 ${
                  index === currentIndex ? "bg-cyan-400 scale-125" : "bg-white/30 hover:bg-white/50"
                }`}
              />
            ))}
          </div>
        </div>
      </div>
    </section>
  )
}


================================================================================
FILE: p2m/components/hero-section.tsx
================================================================================
"use client"

import { useState, useEffect } from "react"
import { motion } from "framer-motion"
import { ArrowRight, Zap } from "lucide-react"
import { Button } from "@/components/ui/button"
import Link from "next/link"
import { useAuth } from "@/hooks/use-auth"

export default function HeroSection() {
  const [mounted, setMounted] = useState(false)
  const { user, isLoading } = useAuth()

  useEffect(() => {
    setMounted(true)
  }, [])

  if (!mounted) {
    return (
      <section id="home" className="relative min-h-screen flex items-center justify-center overflow-hidden">
        <div
          className="absolute inset-0 bg-cover bg-center bg-fixed"
          style={{
            backgroundImage: `linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('/placeholder.svg?height=1080&width=1920')`,
          }}
        />
        <div className="relative z-10 text-center px-4 max-w-6xl mx-auto">
          <h1 className="text-6xl md:text-8xl font-black text-white mb-6 leading-tight">
            AI{" "}
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400">
              AutoExpert
            </span>
          </h1>
        </div>
      </section>
    )
  }

  return (
    <section id="home" className="relative min-h-screen flex items-center justify-center overflow-hidden">
      {/* Background Image with Overlay */}
      <div
        className="absolute inset-0 bg-cover bg-center bg-fixed"
        style={{
          backgroundImage: `linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('/placeholder.svg?height=1080&width=1920')`,
        }}
      />

      {/* Animated Background Elements */}
      <div className="absolute inset-0">
        <motion.div
          animate={{
            scale: [1, 1.2, 1],
            opacity: [0.3, 0.6, 0.3],
          }}
          transition={{
            duration: 8,
            repeat: Number.POSITIVE_INFINITY,
            ease: "easeInOut",
          }}
          className="absolute top-1/4 left-1/4 w-96 h-96 bg-cyan-500/20 rounded-full blur-3xl"
        />
        <motion.div
          animate={{
            scale: [1.2, 1, 1.2],
            opacity: [0.2, 0.5, 0.2],
          }}
          transition={{
            duration: 10,
            repeat: Number.POSITIVE_INFINITY,
            ease: "easeInOut",
          }}
          className="absolute bottom-1/4 right-1/4 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl"
        />
      </div>

      {/* Content */}
      <div className="relative z-10 text-center px-4 max-w-6xl mx-auto">
        <motion.div
          initial={{ opacity: 0, y: 30 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.8, delay: 0.2 }}
          className="mb-8"
        >
          <motion.h1
            className="text-6xl md:text-8xl font-black text-white mb-6 leading-tight"
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 1, delay: 0.3 }}
          >
            AI{" "}
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400">
              AutoExpert
            </span>
          </motion.h1>

          <motion.p
            className="text-xl md:text-2xl text-gray-300 mb-12 max-w-4xl mx-auto leading-relaxed"
            initial={{ opacity: 0, y: 30 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.8, delay: 0.5 }}
          >
            Revolutionary AI-powered vehicle damage assessment and insurance claim processing. Get instant, accurate
            analysis with our cutting-edge technology.
          </motion.p>
        </motion.div>

        {/* CTA Button Container */}
        <motion.div
          initial={{ opacity: 0, y: 30 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.8, delay: 0.7 }}
          className="relative"
        >
          {/* Glowing Background for Button */}
          <div className="absolute inset-0 bg-gradient-to-r from-cyan-500/30 to-purple-500/30 rounded-full blur-xl scale-150" />

          {!isLoading && (
            <Link href={user ? "/analysis" : "/auth"}>
              <Button
                size="lg"
                className="relative bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white font-bold py-6 px-12 rounded-full text-xl border-0 shadow-2xl transform hover:scale-105 transition-all duration-300 group"
              >
                <Zap className="w-6 h-6 mr-3 group-hover:animate-pulse" />
                Start Analysis
                <ArrowRight className="w-6 h-6 ml-3 group-hover:translate-x-1 transition-transform duration-300" />
              </Button>
            </Link>
          )}
        </motion.div>

        {/* Floating Elements */}
        <motion.div
          animate={{ y: [0, -20, 0] }}
          transition={{ duration: 4, repeat: Number.POSITIVE_INFINITY, ease: "easeInOut" }}
          className="absolute top-20 left-10 text-cyan-400 opacity-60"
        >
          <div className="w-4 h-4 bg-cyan-400 rounded-full" />
        </motion.div>

        <motion.div
          animate={{ y: [0, 20, 0] }}
          transition={{ duration: 5, repeat: Number.POSITIVE_INFINITY, ease: "easeInOut", delay: 1 }}
          className="absolute bottom-20 right-10 text-purple-400 opacity-60"
        >
          <div className="w-6 h-6 bg-purple-400 rounded-full" />
        </motion.div>
      </div>

      {/* Scroll Indicator */}
      <motion.div
        animate={{ y: [0, 10, 0] }}
        transition={{ duration: 2, repeat: Number.POSITIVE_INFINITY }}
        className="absolute bottom-8 left-1/2 transform -translate-x-1/2"
      >
        <div className="w-6 h-10 border-2 border-white/30 rounded-full flex justify-center">
          <div className="w-1 h-3 bg-white/60 rounded-full mt-2" />
        </div>
      </motion.div>
    </section>
  )
}


================================================================================
FILE: p2m/components/navbar.tsx
================================================================================
"use client"

import { useState, useEffect } from "react"
import { motion, AnimatePresence } from "framer-motion"
import { Car, Menu, X, User, LogOut } from "lucide-react"
import { Button } from "@/components/ui/button"
import Link from "next/link"
import { useAuth } from "@/hooks/use-auth"

export default function Navbar() {
  const [isOpen, setIsOpen] = useState(false)
  const [scrolled, setScrolled] = useState(false)
  const [mounted, setMounted] = useState(false)

  // Handle client-side mounting
  useEffect(() => {
    setMounted(true)
  }, [])

  const { user, logout, isLoading } = useAuth()

  useEffect(() => {
    const handleScroll = () => {
      setScrolled(window.scrollY > 50)
    }
    window.addEventListener("scroll", handleScroll)
    return () => window.removeEventListener("scroll", handleScroll)
  }, [])

  const scrollToSection = (sectionId: string) => {
    const element = document.getElementById(sectionId)
    if (element) {
      element.scrollIntoView({ behavior: "smooth" })
    }
    setIsOpen(false)
  }

  // Don't render until mounted to avoid hydration issues
  if (!mounted) {
    return null
  }

  return (
    <motion.nav
      initial={{ y: -100 }}
      animate={{ y: 0 }}
      transition={{ duration: 0.6 }}
      className={`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${
        scrolled ? "bg-black/80 backdrop-blur-lg border-b border-white/10" : "bg-transparent"
      }`}
    >
      <div className="max-w-7xl mx-auto px-4">
        <div className="flex items-center justify-between h-16">
          {/* Logo */}
          <motion.div whileHover={{ scale: 1.05 }} className="flex items-center space-x-2">
            <Car className="w-8 h-8 text-cyan-400" />
            <span className="text-2xl font-bold text-white">AI AutoExpert</span>
          </motion.div>

          {/* Desktop Navigation */}
          <div className="hidden md:flex items-center space-x-8">
            <button
              onClick={() => scrollToSection("home")}
              className="text-white hover:text-cyan-400 transition-colors duration-300 font-medium"
            >
              Home
            </button>
            <button
              onClick={() => scrollToSection("about")}
              className="text-white hover:text-cyan-400 transition-colors duration-300 font-medium"
            >
              About
            </button>
            <button
              onClick={() => scrollToSection("services")}
              className="text-white hover:text-cyan-400 transition-colors duration-300 font-medium"
            >
              Services
            </button>
            <button
              onClick={() => scrollToSection("contact")}
              className="text-white hover:text-cyan-400 transition-colors duration-300 font-medium"
            >
              Contact
            </button>

            {!isLoading && (
              <>
                {user ? (
                  <div className="flex items-center space-x-4">
                    <Link href="/dashboard">
                      <Button className="bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                        <User className="w-4 h-4 mr-2" />
                        Dashboard
                      </Button>
                    </Link>
                    <Button
                      onClick={logout}
                      className="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
                    >
                      <LogOut className="w-4 h-4 mr-2" />
                      Logout
                    </Button>
                  </div>
                ) : (
                  <Link href="/auth">
                    <Button className="bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                      Get Started
                    </Button>
                  </Link>
                )}
              </>
            )}
          </div>

          {/* Mobile menu button */}
          <button onClick={() => setIsOpen(!isOpen)} className="md:hidden text-white">
            {isOpen ? <X className="w-6 h-6" /> : <Menu className="w-6 h-6" />}
          </button>
        </div>

        {/* Mobile Navigation */}
        <AnimatePresence>
          {isOpen && (
            <motion.div
              initial={{ opacity: 0, height: 0 }}
              animate={{ opacity: 1, height: "auto" }}
              exit={{ opacity: 0, height: 0 }}
              transition={{ duration: 0.3 }}
              className="md:hidden bg-black/90 backdrop-blur-lg border-t border-white/10"
            >
              <div className="px-4 py-6 space-y-4">
                <button
                  onClick={() => scrollToSection("home")}
                  className="block w-full text-left text-white hover:text-cyan-400 transition-colors duration-300 font-medium"
                >
                  Home
                </button>
                <button
                  onClick={() => scrollToSection("about")}
                  className="block w-full text-left text-white hover:text-cyan-400 transition-colors duration-300 font-medium"
                >
                  About
                </button>
                <button
                  onClick={() => scrollToSection("services")}
                  className="block w-full text-left text-white hover:text-cyan-400 transition-colors duration-300 font-medium"
                >
                  Services
                </button>
                <button
                  onClick={() => scrollToSection("contact")}
                  className="block w-full text-left text-white hover:text-cyan-400 transition-colors duration-300 font-medium"
                >
                  Contact
                </button>
                {!isLoading && (
                  <>
                    {user ? (
                      <div className="flex flex-col space-y-4">
                        <Link href="/dashboard">
                          <Button className="w-full bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                            <User className="w-4 h-4 mr-2" />
                            Dashboard
                          </Button>
                        </Link>
                        <Button
                          onClick={logout}
                          className="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
                        >
                          <LogOut className="w-4 h-4 mr-2" />
                          Logout
                        </Button>
                      </div>
                    ) : (
                      <Link href="/auth">
                        <Button className="w-full bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                          Get Started
                        </Button>
                      </Link>
                    )}
                  </>
                )}
              </div>
            </motion.div>
          )}
        </AnimatePresence>
      </div>
    </motion.nav>
  )
}


================================================================================
FILE: p2m/components/news-section.tsx
================================================================================
"use client"

import { motion } from "framer-motion"
import { Calendar, TrendingUp, AlertTriangle, Shield } from "lucide-react"
import { Card, CardContent } from "@/components/ui/card"
import { Button } from "@/components/ui/button"

const newsItems = [
  {
    id: 1,
    title: "Insurance Claims Rise 15% Due to Weather-Related Accidents",
    excerpt:
      "Recent storms across Tunisia have led to a significant increase in vehicle damage claims, with most incidents involving flooding and hail damage.",
    date: "2024-01-15",
    category: "Statistics",
    icon: TrendingUp,
    gradient: "from-blue-500 to-cyan-500",
  },
  {
    id: 2,
    title: "New AI Technology Reduces Fraudulent Claims by 40%",
    excerpt:
      "Advanced machine learning algorithms are helping insurance companies detect and prevent fraudulent damage claims more effectively than ever before.",
    date: "2024-01-12",
    category: "Technology",
    icon: Shield,
    gradient: "from-green-500 to-emerald-500",
  },
  {
    id: 3,
    title: "Road Safety Alert: Increased Accidents on Highway A1",
    excerpt:
      "Authorities report a 25% increase in accidents on the main Tunis-Sfax highway due to ongoing construction work. Drivers advised to exercise caution.",
    date: "2024-01-10",
    category: "Safety Alert",
    icon: AlertTriangle,
    gradient: "from-red-500 to-orange-500",
  },
  {
    id: 4,
    title: "Digital Insurance Processing Speeds Up Claims by 60%",
    excerpt:
      "New digital platforms and AI-powered assessment tools are dramatically reducing the time needed to process vehicle damage claims.",
    date: "2024-01-08",
    category: "Innovation",
    icon: TrendingUp,
    gradient: "from-purple-500 to-pink-500",
  },
]

export default function NewsSection() {
  return (
    <section className="py-20 px-4 bg-black/20">
      <div className="max-w-7xl mx-auto">
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6 }}
          viewport={{ once: true }}
          className="text-center mb-16"
        >
          <h2 className="text-5xl font-bold text-white mb-6">
            Insurance & Accident{" "}
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-400">News</span>
          </h2>
          <p className="text-xl text-gray-300 max-w-3xl mx-auto">
            Stay updated with the latest news and trends in automotive insurance and road safety
          </p>
        </motion.div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
          {newsItems.map((item, index) => (
            <motion.div
              key={item.id}
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.6, delay: index * 0.1 }}
              viewport={{ once: true }}
              whileHover={{ scale: 1.02 }}
              className="group cursor-pointer"
            >
              <Card className="bg-white/10 backdrop-blur-lg border-white/20 hover:bg-white/15 transition-all duration-300 h-full">
                <CardContent className="p-6">
                  <div className="flex items-start space-x-4">
                    <div
                      className={`p-3 rounded-full bg-gradient-to-r ${item.gradient} flex-shrink-0 group-hover:scale-110 transition-transform duration-300`}
                    >
                      <item.icon className="w-6 h-6 text-white" />
                    </div>

                    <div className="flex-1">
                      <div className="flex items-center space-x-2 mb-2">
                        <span
                          className={`px-3 py-1 rounded-full text-xs font-semibold bg-gradient-to-r ${item.gradient} text-white`}
                        >
                          {item.category}
                        </span>
                        <div className="flex items-center text-gray-400 text-sm">
                          <Calendar className="w-4 h-4 mr-1" />
                          {new Date(item.date).toLocaleDateString("en-US", {
                            month: "short",
                            day: "numeric",
                            year: "numeric",
                          })}
                        </div>
                      </div>

                      <h3 className="text-xl font-bold text-white mb-3 group-hover:text-cyan-400 transition-colors duration-300">
                        {item.title}
                      </h3>

                      <p className="text-gray-300 leading-relaxed">{item.excerpt}</p>
                    </div>
                  </div>
                </CardContent>
              </Card>
            </motion.div>
          ))}
        </div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6, delay: 0.4 }}
          viewport={{ once: true }}
          className="text-center mt-12"
        >
          <Button className="bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
            View All News
          </Button>
        </motion.div>
      </div>
    </section>
  )
}


================================================================================
FILE: p2m/components/results-step.tsx
================================================================================
"use client"

import { useState, useEffect } from "react"
import { motion } from "framer-motion"
import { CheckCircle, Car, AlertTriangle, DollarSign, ArrowLeft, RotateCcw, Download } from "lucide-react"
import { Button } from "@/components/ui/button"
import { Card, CardContent } from "@/components/ui/card"
import GarageCarousel from "@/components/garage-carousel"

interface ResultsStepProps {
  uploadedImage: File | null
  detectionMethod: string | null
  analysisResults: any
  setAnalysisResults: (results: any) => void
  onReset: () => void
  onBack: () => void
}

export default function ResultsStep({
  uploadedImage,
  detectionMethod,
  analysisResults,
  setAnalysisResults,
  onReset,
  onBack,
}: ResultsStepProps) {
  const [isAnalyzing, setIsAnalyzing] = useState(false)
  const [error, setError] = useState<string | null>(null)

  useEffect(() => {
    if (!analysisResults && uploadedImage && detectionMethod) {
      runAnalysis()
    }
  }, [uploadedImage, detectionMethod, analysisResults])

  const runAnalysis = async () => {
    if (!uploadedImage || !detectionMethod) return

    setIsAnalyzing(true)
    setError(null)

    try {
      // Step 1: Run damage detection
      const formData = new FormData()
      formData.append("image", uploadedImage)
      formData.append("method", detectionMethod)

      const detectionResponse = await fetch("/api/damage-detection", {
        method: "POST",
        body: formData,
      })

      if (!detectionResponse.ok) {
        const errorText = await detectionResponse.text()
        throw new Error(`Damage detection failed: ${errorText}`)
      }

      const detectionResult = await detectionResponse.json()

      // Generate mock cost estimation if we don't have a real API
      let costResult
      try {
        // Step 2: Estimate costs based on detections
        const costResponse = await fetch("/api/cost-estimation", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            detections: detectionResult.detections,
            brand: extractBrandFromDetections(detectionResult.detections) || "Unknown",
          }),
        })

        if (!costResponse.ok) {
          throw new Error("Cost estimation failed")
        }

        costResult = await costResponse.json()
      } catch (costError) {
        console.error("Cost estimation error:", costError)

        // Fallback to mock cost data
        const brand = extractBrandFromDetections(detectionResult.detections) || "BMW"
        const totalCost = Math.round(1500 + Math.random() * 1000)

        costResult = {
          total_cost: totalCost,
          parts_cost: Math.round(totalCost * 0.7),
          labor_cost: Math.round(totalCost * 0.3),
          brand: brand,
          breakdown: detectionResult.detections.map((d: any) => ({
            damage_type: d.class,
            severity: d.confidence > 0.8 ? "severe" : d.confidence > 0.6 ? "moderate" : "minor",
            confidence: d.confidence,
            cost: Math.round(300 + Math.random() * 500),
            location: d.bbox,
          })),
          currency: "DT",
          note: "Using mock cost data",
        }
      }

      // Combine results
      const finalResults = {
        detections: detectionResult.detections,
        annotatedImage: detectionResult.annotated_image,
        confidence: detectionResult.confidence,
        method: detectionMethod,
        brand: costResult.brand,
        totalCost: costResult.total_cost,
        partsCost: costResult.parts_cost,
        laborCost: costResult.labor_cost,
        breakdown: costResult.breakdown,
        processingTime: detectionResult.processing_time,
        note: detectionResult.note || costResult.note,
      }

      setAnalysisResults(finalResults)
    } catch (error) {
      console.error("Analysis failed:", error)
      setError("Analysis failed. Using mock data instead.")

      // Provide mock results as fallback
      const mockDetections = [
        {
          class: "dent",
          confidence: 0.92,
          bbox: [120, 80, 200, 150],
        },
        {
          class: "scratch",
          confidence: 0.87,
          bbox: [300, 200, 450, 280],
        },
      ]

      const brand = "BMW"
      const totalCost = 2250

      setAnalysisResults({
        detections: mockDetections,
        annotatedImage: null,
        confidence: 0.895,
        method: detectionMethod,
        brand: brand,
        totalCost: totalCost,
        partsCost: Math.round(totalCost * 0.7),
        laborCost: Math.round(totalCost * 0.3),
        breakdown: mockDetections.map((d) => ({
          damage_type: d.class,
          severity: d.confidence > 0.8 ? "severe" : "moderate",
          confidence: d.confidence,
          cost: d.class === "dent" ? 1350 : 900,
          location: d.bbox,
        })),
        processingTime: 1.8,
        note: "Using mock data due to service unavailability",
      })
    } finally {
      setIsAnalyzing(false)
    }
  }

  const extractBrandFromDetections = (detections: any[]) => {
    // Look for brand-specific detections or use image classification
    const brands = ["BMW", "Mercedes", "Audi", "Toyota", "Honda", "Volkswagen", "Ford", "Peugeot", "Renault", "Hyundai"]

    if (!detections || !Array.isArray(detections)) {
      return "BMW" // Default brand
    }

    for (const detection of detections) {
      for (const brand of brands) {
        if (detection.class && detection.class.toLowerCase().includes(brand.toLowerCase())) {
          return brand
        }
      }
    }

    return "BMW" // Default to BMW if no brand detected
  }

  if (error) {
    return (
      <div className="max-w-4xl mx-auto">
        <Card className="bg-red-500/20 border-red-500/30">
          <CardContent className="p-8 text-center">
            <AlertTriangle className="w-16 h-16 text-red-400 mx-auto mb-4" />
            <h3 className="text-2xl font-bold text-red-400 mb-4">Analysis Warning</h3>
            <p className="text-gray-300 mb-6">{error}</p>
          </CardContent>
        </Card>
      </div>
    )
  }

  if (isAnalyzing) {
    return (
      <div className="max-w-4xl mx-auto">
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6 }}
          className="text-center"
        >
          <div className="w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4">
            <CheckCircle className="w-8 h-8 text-white" />
          </div>
          <h2 className="text-3xl font-bold text-white mb-4">Analyzing Your Vehicle</h2>
          <p className="text-gray-300 text-lg mb-8">
            Running {detectionMethod?.toUpperCase()} detection and cost estimation using your trained models
          </p>

          <Card className="bg-white/10 backdrop-blur-lg border-white/20 max-w-md mx-auto">
            <CardContent className="p-8 text-center">
              <motion.div
                animate={{ rotate: 360 }}
                transition={{ duration: 2, repeat: Number.POSITIVE_INFINITY, ease: "linear" }}
                className="w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full mx-auto mb-6"
              />
              <div className="space-y-3">
                <motion.p
                  initial={{ opacity: 0.5 }}
                  animate={{ opacity: 1 }}
                  transition={{ duration: 1, repeat: Number.POSITIVE_INFINITY, repeatType: "reverse" }}
                  className="text-white font-medium"
                >
                  {detectionMethod === "yolo"
                    ? "Running YOLO detection (best.pt)..."
                    : "Running damage classification (car-damage-model.h5)..."}
                </motion.p>
                <motion.p
                  initial={{ opacity: 0.5 }}
                  animate={{ opacity: 1 }}
                  transition={{ duration: 1, delay: 1, repeat: Number.POSITIVE_INFINITY, repeatType: "reverse" }}
                  className="text-gray-300"
                >
                  Identifying damaged components...
                </motion.p>
                <motion.p
                  initial={{ opacity: 0.5 }}
                  animate={{ opacity: 1 }}
                  transition={{ duration: 1, delay: 2, repeat: Number.POSITIVE_INFINITY, repeatType: "reverse" }}
                  className="text-gray-300"
                >
                  Calculating repair costs...
                </motion.p>
              </div>
            </CardContent>
          </Card>
        </motion.div>
      </div>
    )
  }

  if (!analysisResults) {
    return null
  }

  return (
    <div className="max-w-6xl mx-auto">
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6 }}
        className="text-center mb-8"
      >
        <div className="w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4">
          <CheckCircle className="w-8 h-8 text-white" />
        </div>
        <h2 className="text-3xl font-bold text-white mb-4">Analysis Complete</h2>
        <p className="text-gray-300 text-lg">
          {analysisResults.method?.toUpperCase()} detection completed in{" "}
          {analysisResults.processingTime?.toFixed(2) || "1.8"}s
        </p>
        {analysisResults.note && <p className="text-yellow-300 text-sm mt-2">{analysisResults.note}</p>}
      </motion.div>

      {/* Detection Results */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
        <motion.div
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.6, delay: 0.2 }}
        >
          <Card className="bg-white/10 backdrop-blur-lg border-white/20">
            <CardContent className="p-8">
              <h3 className="text-2xl font-bold text-white mb-6">
                {analysisResults.method?.toUpperCase()} Detection Results
              </h3>
              <div className="aspect-video rounded-lg overflow-hidden mb-4">
                {analysisResults.annotatedImage ? (
                  <img
                    src={`data:image/jpeg;base64,${analysisResults.annotatedImage}`}
                    alt="Detection results"
                    className="w-full h-full object-cover"
                  />
                ) : (
                  <img
                    src={URL.createObjectURL(uploadedImage!) || "/placeholder.svg"}
                    alt="Original image"
                    className="w-full h-full object-cover"
                  />
                )}
              </div>
              <p className="text-gray-300 text-center">
                Detected {analysisResults.detections?.length || 0} damaged components with{" "}
                {((analysisResults.confidence || 0.9) * 100).toFixed(1)}% average confidence
              </p>
            </CardContent>
          </Card>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, x: 20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.6, delay: 0.4 }}
        >
          <Card className="bg-white/10 backdrop-blur-lg border-white/20">
            <CardContent className="p-8">
              <h3 className="text-2xl font-bold text-white mb-6">Detected Damages</h3>

              <div className="space-y-3 mb-6">
                {analysisResults.breakdown?.map((item: any, index: number) => (
                  <div key={index} className="bg-white/5 rounded-lg p-3 border border-white/10">
                    <div className="flex justify-between items-center">
                      <div>
                        <p className="text-white font-medium">{item.damage_type}</p>
                        <p className="text-gray-400 text-sm">
                          {item.severity} severity ‚Ä¢ {((item.confidence || 0.9) * 100).toFixed(1)}% confidence
                        </p>
                      </div>
                      <p className="text-cyan-400 font-bold">{item.cost} DT</p>
                    </div>
                  </div>
                ))}
              </div>

              <div className="bg-cyan-500/20 rounded-lg p-4 text-center">
                <Car className="w-8 h-8 text-cyan-400 mx-auto mb-2" />
                <p className="text-cyan-300 font-semibold">Vehicle Brand</p>
                <p className="text-white text-xl font-bold">{analysisResults.brand}</p>
              </div>
            </CardContent>
          </Card>
        </motion.div>
      </div>

      {/* Cost Estimation */}
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6, delay: 0.6 }}
        className="mb-8"
      >
        <Card className="bg-gradient-to-r from-yellow-500/20 to-orange-500/20 border-yellow-500/30">
          <CardContent className="p-8">
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
              <div>
                <DollarSign className="w-12 h-12 text-yellow-400 mx-auto mb-2" />
                <h4 className="text-lg font-semibold text-white mb-1">Parts Cost</h4>
                <p className="text-2xl font-bold text-yellow-400">{analysisResults.partsCost} DT</p>
              </div>
              <div>
                <DollarSign className="w-12 h-12 text-orange-400 mx-auto mb-2" />
                <h4 className="text-lg font-semibold text-white mb-1">Labor Cost</h4>
                <p className="text-2xl font-bold text-orange-400">{analysisResults.laborCost} DT</p>
              </div>
              <div>
                <DollarSign className="w-12 h-12 text-green-400 mx-auto mb-2" />
                <h4 className="text-lg font-semibold text-white mb-1">Total Estimate</h4>
                <p className="text-3xl font-bold text-green-400">{analysisResults.totalCost} DT</p>
              </div>
            </div>
          </CardContent>
        </Card>
      </motion.div>

      {/* Action Buttons */}
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6, delay: 0.8 }}
        className="flex flex-wrap gap-4 justify-center mb-12"
      >
        <Button
          onClick={onReset}
          className="bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
        >
          <RotateCcw className="w-4 h-4 mr-2" />
          New Analysis
        </Button>

        <Button className="bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
          <Download className="w-4 h-4 mr-2" />
          Download Report
        </Button>

        <Button
          onClick={onBack}
          className="bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"
        >
          <ArrowLeft className="w-4 h-4 mr-2" />
          Back to Detection
        </Button>
      </motion.div>

      {/* Garage Recommendations */}
      <GarageCarousel />
    </div>
  )
}


================================================================================
FILE: p2m/components/ui/button.tsx
================================================================================
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default:
          "bg-primary text-primary-foreground shadow hover:bg-primary/90",
        destructive:
          "bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",
        outline:
          "border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",
        secondary:
          "bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",
        ghost: "hover:bg-accent hover:text-accent-foreground",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2",
        sm: "h-8 rounded-md px-3 text-xs",
        lg: "h-10 rounded-md px-8",
        icon: "h-9 w-9",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button"
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = "Button"

export { Button, buttonVariants }


================================================================================
FILE: p2m/components/ui/card.tsx
================================================================================
import * as React from "react"

import { cn } from "@/lib/utils"

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "rounded-xl border bg-card text-card-foreground shadow",
      className
    )}
    {...props}
  />
))
Card.displayName = "Card"

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex flex-col space-y-1.5 p-6", className)}
    {...props}
  />
))
CardHeader.displayName = "CardHeader"

const CardTitle = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("font-semibold leading-none tracking-tight", className)}
    {...props}
  />
))
CardTitle.displayName = "CardTitle"

const CardDescription = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
CardDescription.displayName = "CardDescription"

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
))
CardContent.displayName = "CardContent"

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex items-center p-6 pt-0", className)}
    {...props}
  />
))
CardFooter.displayName = "CardFooter"

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }


================================================================================
FILE: p2m/components/ui/input.tsx
================================================================================
import * as React from "react"

import { cn } from "@/lib/utils"

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<"input">>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Input.displayName = "Input"

export { Input }


================================================================================
FILE: p2m/components/ui/label.tsx
================================================================================
"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const labelVariants = cva(
  "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
)

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }


================================================================================
FILE: p2m/components/ui/tabs.tsx
================================================================================
"use client"

import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

const Tabs = TabsPrimitive.Root

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      "inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",
      className
    )}
    {...props}
  />
))
TabsList.displayName = TabsPrimitive.List.displayName

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      "inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",
      className
    )}
    {...props}
  />
))
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
      className
    )}
    {...props}
  />
))
TabsContent.displayName = TabsPrimitive.Content.displayName

export { Tabs, TabsList, TabsTrigger, TabsContent }


================================================================================
FILE: p2m/components/upload-step.tsx
================================================================================
"use client"

import type React from "react"

import { useState, useCallback } from "react"
import { motion } from "framer-motion"
import { Upload, ImageIcon, X, ArrowRight } from "lucide-react"
import { Button } from "@/components/ui/button"
import { Card, CardContent } from "@/components/ui/card"

interface UploadStepProps {
  uploadedImage: File | null
  setUploadedImage: (file: File | null) => void
  onNext: () => void
}

export default function UploadStep({ uploadedImage, setUploadedImage, onNext }: UploadStepProps) {
  const [dragActive, setDragActive] = useState(false)

  const handleDrag = useCallback((e: React.DragEvent) => {
    e.preventDefault()
    e.stopPropagation()
    if (e.type === "dragenter" || e.type === "dragover") {
      setDragActive(true)
    } else if (e.type === "dragleave") {
      setDragActive(false)
    }
  }, [])

  const handleDrop = useCallback(
    (e: React.DragEvent) => {
      e.preventDefault()
      e.stopPropagation()
      setDragActive(false)

      if (e.dataTransfer.files && e.dataTransfer.files[0]) {
        const file = e.dataTransfer.files[0]
        if (file.type.startsWith("image/")) {
          setUploadedImage(file)
        }
      }
    },
    [setUploadedImage],
  )

  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    if (e.target.files && e.target.files[0]) {
      setUploadedImage(e.target.files[0])
    }
  }

  const removeImage = () => {
    setUploadedImage(null)
  }

  return (
    <div className="max-w-4xl mx-auto">
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6 }}
        className="text-center mb-8"
      >
        <div className="w-16 h-16 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
          <Upload className="w-8 h-8 text-white" />
        </div>
        <h2 className="text-3xl font-bold text-white mb-4">Upload Your Car Image</h2>
        <p className="text-gray-300 text-lg">Please upload a clear image of your vehicle for analysis</p>
      </motion.div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <motion.div
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ duration: 0.6, delay: 0.2 }}
        >
          <Card className="bg-white/10 backdrop-blur-lg border-white/20">
            <CardContent className="p-8">
              <div
                className={`relative border-2 border-dashed rounded-lg p-8 text-center transition-all duration-300 ${
                  dragActive
                    ? "border-cyan-400 bg-cyan-400/10"
                    : uploadedImage
                      ? "border-green-400 bg-green-400/10"
                      : "border-white/30 hover:border-white/50"
                }`}
                onDragEnter={handleDrag}
                onDragLeave={handleDrag}
                onDragOver={handleDrag}
                onDrop={handleDrop}
              >
                <input
                  type="file"
                  accept="image/*"
                  onChange={handleFileChange}
                  className="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                />

                {uploadedImage ? (
                  <div className="space-y-4">
                    <div className="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto">
                      <ImageIcon className="w-8 h-8 text-white" />
                    </div>
                    <div>
                      <p className="text-white font-medium">{uploadedImage.name}</p>
                      <p className="text-gray-300 text-sm">{(uploadedImage.size / 1024 / 1024).toFixed(2)} MB</p>
                    </div>
                    <Button
                      onClick={removeImage}
                      variant="outline"
                      size="sm"
                      className="border-red-400 text-red-400 hover:bg-red-400 hover:text-white"
                    >
                      <X className="w-4 h-4 mr-2" />
                      Remove
                    </Button>
                  </div>
                ) : (
                  <div className="space-y-4">
                    <div className="w-16 h-16 bg-white/10 rounded-full flex items-center justify-center mx-auto">
                      <Upload className="w-8 h-8 text-white" />
                    </div>
                    <div>
                      <p className="text-white font-medium mb-2">Drag and drop your image here, or click to browse</p>
                      <p className="text-gray-400 text-sm">Supports JPG, PNG, JPEG, WEBP (Max 10MB)</p>
                    </div>
                  </div>
                )}
              </div>

              {uploadedImage && (
                <motion.div
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ duration: 0.3 }}
                  className="mt-6"
                >
                  <Button
                    onClick={onNext}
                    className="w-full bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600"
                  >
                    Start AI Analysis
                    <ArrowRight className="w-4 h-4 ml-2" />
                  </Button>
                </motion.div>
              )}
            </CardContent>
          </Card>
        </motion.div>

        {uploadedImage && (
          <motion.div
            initial={{ opacity: 0, x: 20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ duration: 0.6, delay: 0.4 }}
          >
            <Card className="bg-white/10 backdrop-blur-lg border-white/20">
              <CardContent className="p-8">
                <h3 className="text-xl font-bold text-white mb-4">Image Preview</h3>
                <div className="aspect-video rounded-lg overflow-hidden">
                  <img
                    src={URL.createObjectURL(uploadedImage) || "/placeholder.svg"}
                    alt="Uploaded vehicle"
                    className="w-full h-full object-cover"
                  />
                </div>
              </CardContent>
            </Card>
          </motion.div>
        )}
      </div>
    </div>
  )
}


================================================================================
FILE: p2m/hooks/use-auth.tsx
================================================================================
"use client"

import { createContext, useContext, useState, useEffect, type ReactNode } from "react"

interface User {
  username: string
  email: string
  dateOfBirth: string
  cinNumber: string
  phoneNumber: string
  createdAt: string
  analysesCount: number
  analysisHistory: any[]
}

interface AuthContextType {
  user: User | null
  login: (username: string, password: string, rememberMe?: boolean) => Promise<void>
  register: (userData: any) => Promise<void>
  logout: () => void
  isLoading: boolean
}

const AuthContext = createContext<AuthContextType | undefined>(undefined)

export function AuthProvider({ children }: { children: ReactNode }) {
  const [user, setUser] = useState<User | null>(null)
  const [isLoading, setIsLoading] = useState(true)
  const [isInitialized, setIsInitialized] = useState(false)

  useEffect(() => {
    // Only run on client side
    if (typeof window === "undefined") return

    const initializeAuth = () => {
      try {
        // Check for remembered login
        const rememberedUser = localStorage.getItem("rememberedUser")
        const loginTime = localStorage.getItem("loginTime")

        if (rememberedUser && loginTime) {
          const daysSinceLogin = (Date.now() - Number.parseInt(loginTime)) / (1000 * 60 * 60 * 24)
          if (daysSinceLogin < 30) {
            // Load user data from localStorage
            const userData = localStorage.getItem(`user_${rememberedUser}`)
            if (userData) {
              try {
                setUser(JSON.parse(userData))
              } catch (error) {
                console.error("Error parsing user data:", error)
                // Clear corrupted data
                localStorage.removeItem(`user_${rememberedUser}`)
                localStorage.removeItem("rememberedUser")
                localStorage.removeItem("loginTime")
              }
            }
          } else {
            // Clear expired login
            localStorage.removeItem("rememberedUser")
            localStorage.removeItem("loginTime")
          }
        }
      } catch (error) {
        console.error("Error initializing auth:", error)
      } finally {
        setIsLoading(false)
        setIsInitialized(true)
      }
    }

    initializeAuth()
  }, [])

  const login = async (username: string, password: string, rememberMe = false) => {
    setIsLoading(true)

    try {
      // In a real app, this would be an API call
      const users = JSON.parse(localStorage.getItem("users") || "{}")
      const hashedPassword = await hashPassword(password)

      if (users[username] && users[username].password === hashedPassword) {
        const userData = users[username]
        setUser(userData)

        if (rememberMe) {
          localStorage.setItem("rememberedUser", username)
          localStorage.setItem("loginTime", Date.now().toString())
        }

        localStorage.setItem(`user_${username}`, JSON.stringify(userData))
      } else {
        throw new Error("Invalid credentials")
      }
    } catch (error) {
      throw error
    } finally {
      setIsLoading(false)
    }
  }

  const register = async (userData: any) => {
    setIsLoading(true)

    try {
      // Validate data
      if (userData.password !== userData.confirmPassword) {
        throw new Error("Passwords do not match")
      }

      if (!validateCIN(userData.cinNumber)) {
        throw new Error("Invalid CIN number")
      }

      if (!validatePhone(userData.phoneNumber)) {
        throw new Error("Invalid phone number")
      }

      // In a real app, this would be an API call
      const users = JSON.parse(localStorage.getItem("users") || "{}")

      if (users[userData.username]) {
        throw new Error("Username already exists")
      }

      const hashedPassword = await hashPassword(userData.password)
      const newUser = {
        username: userData.username,
        email: userData.email,
        password: hashedPassword,
        dateOfBirth: userData.dateOfBirth,
        cinNumber: userData.cinNumber,
        phoneNumber: userData.phoneNumber,
        createdAt: new Date().toISOString(),
        analysesCount: 0,
        analysisHistory: [],
      }

      users[userData.username] = newUser
      localStorage.setItem("users", JSON.stringify(users))

      // Auto-login after registration
      const userForState = { ...newUser }
      delete userForState.password // Don't store password in state
      setUser(userForState)
      localStorage.setItem(`user_${userData.username}`, JSON.stringify(userForState))
    } catch (error) {
      throw error
    } finally {
      setIsLoading(false)
    }
  }

  const logout = () => {
    setUser(null)
    if (typeof window !== "undefined") {
      localStorage.removeItem("rememberedUser")
      localStorage.removeItem("loginTime")
      if (user) {
        localStorage.removeItem(`user_${user.username}`)
      }
    }
  }

  // Don't render children until initialized
  if (!isInitialized) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center">
        <div className="text-white text-center">
          <div className="w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
          <p>Loading...</p>
        </div>
      </div>
    )
  }

  return <AuthContext.Provider value={{ user, login, register, logout, isLoading }}>{children}</AuthContext.Provider>
}

export function useAuth() {
  const context = useContext(AuthContext)
  if (context === undefined) {
    throw new Error("useAuth must be used within an AuthProvider")
  }
  return context
}

// Utility functions
async function hashPassword(password: string): Promise<string> {
  const encoder = new TextEncoder()
  const data = encoder.encode(password)
  const hash = await crypto.subtle.digest("SHA-256", data)
  return Array.from(new Uint8Array(hash))
    .map((b) => b.toString(16).padStart(2, "0"))
    .join("")
}

function validateCIN(cin: string): boolean {
  return /^\d{8}$/.test(cin)
}

function validatePhone(phone: string): boolean {
  return /^(\+216|216|0)?[2-9]\d{7}$/.test(phone)
}


================================================================================
FILE: p2m/lib/utils.ts
================================================================================
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}


================================================================================
FILE: p2m/next-env.d.ts
================================================================================
/// <reference types="next" />
/// <reference types="next/image-types/global" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/building-your-application/configuring/typescript for more information.


================================================================================
FILE: p2m/package.json
================================================================================
{
  "name": "ai-auto-expert",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
  "dependencies": {
    "@radix-ui/react-label": "^2.0.2",
    "@radix-ui/react-tabs": "^1.0.4",
    "ai-auto-expert": "file:",
    "class-variance-authority": "^0.7.0",
    "clsx": "^2.0.0",
    "framer-motion": "^10.16.4",
    "lucide-react": "^0.292.0",
    "next": "14.0.0",
    "react": "^18",
    "react-dom": "^18",
    "tailwind-merge": "^2.0.0"
  },
  "devDependencies": {
    "@types/node": "^20",
    "@types/react": "^18",
    "@types/react-dom": "^18",
    "autoprefixer": "^10.0.1",
    "eslint": "^8",
    "eslint-config-next": "14.0.0",
    "postcss": "^8",
    "tailwindcss": "^3.3.0",
    "typescript": "^5"
  }
}


================================================================================
FILE: p2m/python-ai-service/.env.example
================================================================================
[SENSITIVE FILE - CONTENT NOT DISPLAYED FOR SECURITY]
This file may contain passwords, API keys, or credentials.


================================================================================
FILE: p2m/python-ai-service/main.py
================================================================================
from fastapi import FastAPI, HTTPException
from fastapi.middleware.cors import CORSMiddleware
import uvicorn
import base64
import cv2
import numpy as np
import torch
import tensorflow as tf
from PIL import Image
import io
import time
import os
from typing import List, Dict, Any
from roboflow import Roboflow
from transformers import AutoImageProcessor, AutoModelForImageClassification, pipeline
import logging

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

app = FastAPI(title="AI AutoExpert Detection Service")

# Enable CORS
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Global model variables
yolo_model = None
gnet_model = None
damage_severity_model = None
roboflow_model = None
car_brand_pipeline = None
damage_type_pipeline = None

def load_gnet_model():
    """Load GNet model for AI-or-not detection"""
    global gnet_model
    try:
        model_path = "models/gnet.h5"
        if os.path.exists(model_path):
            gnet_model = tf.keras.models.load_model(model_path)
            logger.info("‚úÖ GNet AI detection model loaded successfully")
        else:
            logger.warning(f"‚ùå GNet model not found at {model_path}")
    except Exception as e:
        logger.error(f"‚ùå Error loading GNet model: {e}")

def load_yolo_model():
    """Load YOLO model for object detection"""
    global yolo_model
    try:
        model_path = "models/best.pt"
        if os.path.exists(model_path):
            yolo_model = torch.hub.load('ultralytics/yolov5', 'custom', path=model_path)
            logger.info("‚úÖ YOLO model loaded successfully")
        else:
            logger.warning(f"‚ùå YOLO model not found at {model_path}")
    except Exception as e:
        logger.error(f"‚ùå Error loading YOLO model: {e}")

def load_damage_severity_model():
    """Load car damage severity model"""
    global damage_severity_model
    try:
        model_path = "models/car-damage-model.h5"
        if os.path.exists(model_path):
            damage_severity_model = tf.keras.models.load_model(model_path)
            logger.info("‚úÖ Car damage severity model loaded successfully")
        else:
            logger.warning(f"‚ùå Damage severity model not found at {model_path}")
    except Exception as e:
        logger.error(f"‚ùå Error loading damage severity model: {e}")

def load_roboflow_model():
    """Load Roboflow model for car damage detection"""
    global roboflow_model
    try:
        api_key = os.getenv("ROBOFLOW_API_KEY", "EJdF3gB2PwrQDNlVhauC")
        rf = Roboflow(api_key=api_key)
        project = rf.workspace().project("car-damage-coco-v9i")
        roboflow_model = project.version(1).model
        logger.info("‚úÖ Roboflow model loaded successfully")
    except Exception as e:
        logger.error(f"‚ùå Error loading Roboflow model: {e}")

def load_car_brand_model():
    """Load car brand detection model from Hugging Face"""
    global car_brand_pipeline
    try:
        processor = AutoImageProcessor.from_pretrained("dima806/car_brands_image_detection")
        model = AutoModelForImageClassification.from_pretrained("dima806/car_brands_image_detection")
        car_brand_pipeline = pipeline("image-classification", model=model, feature_extractor=processor)
        logger.info("‚úÖ Car brand detection model loaded successfully")
    except Exception as e:
        logger.error(f"‚ùå Error loading car brand model: {e}")

def load_damage_type_model():
    """Load damage type detection model from Hugging Face"""
    global damage_type_pipeline
    try:
        processor = AutoImageProcessor.from_pretrained("beingamit99/car_damage_detection")
        model = AutoModelForImageClassification.from_pretrained("beingamit99/car_damage_detection")
        damage_type_pipeline = pipeline("image-classification", model=model, feature_extractor=processor)
        logger.info("‚úÖ Damage type detection model loaded successfully")
    except Exception as e:
        logger.error(f"‚ùå Error loading damage type model: {e}")

@app.on_event("startup")
async def startup_event():
    """Load all models on startup"""
    logger.info("üöÄ Starting AI AutoExpert Service...")
    
    # Create models directory if it doesn't exist
    os.makedirs("models", exist_ok=True)
    
    # Load all models
    load_gnet_model()
    load_yolo_model()
    load_damage_severity_model()
    load_roboflow_model()
    load_car_brand_model()
    load_damage_type_model()
    
    logger.info("üéâ AI AutoExpert Service started successfully!")

def decode_base64_image(base64_string: str) -> np.ndarray:
    """Decode base64 image to numpy array"""
    image_data = base64.b64decode(base64_string)
    image = Image.open(io.BytesIO(image_data))
    return cv2.cvtColor(np.array(image), cv2.COLOR_RGB2BGR)

def encode_image_to_base64(image: np.ndarray) -> str:
    """Encode numpy array image to base64"""
    _, buffer = cv2.imencode('.jpg', image)
    return base64.b64encode(buffer).decode('utf-8')

def pil_to_cv2(pil_image: Image.Image) -> np.ndarray:
    """Convert PIL image to OpenCV format"""
    return cv2.cvtColor(np.array(pil_image), cv2.COLOR_RGB2BGR)

@app.post("/ai-check")
async def check_ai_generated(request: Dict[str, Any]):
    """Check if image is AI-generated using GNet model"""
    if gnet_model is None:
        raise HTTPException(status_code=500, detail="GNet model not loaded")
    
    try:
        start_time = time.time()
        
        # Decode image
        image = decode_base64_image(request["image"])
        
        # Preprocess for GNet (adjust size based on your model requirements)
        image_rgb = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
        image_resized = cv2.resize(image_rgb, (224, 224))  # Adjust size if needed
        image_normalized = image_resized / 255.0
        image_batch = np.expand_dims(image_normalized, axis=0)
        
        # Predict
        prediction = gnet_model.predict(image_batch, verbose=0)[0][0]
        
        # Interpret prediction (adjust threshold based on your model)
        is_ai = prediction > 0.5
        confidence = prediction if is_ai else 1 - prediction
        
        processing_time = time.time() - start_time
        
        return {
            "is_ai_generated": bool(is_ai),
            "confidence": float(confidence),
            "processing_time": processing_time,
            "model_used": "gnet.h5"
        }
        
    except Exception as e:
        logger.error(f"AI detection error: {e}")
        raise HTTPException(status_code=500, detail=f"AI detection failed: {str(e)}")

@app.post("/yolo-detect")
async def yolo_detection(request: Dict[str, Any]):
    """Detect car damage using YOLO model"""
    if yolo_model is None:
        raise HTTPException(status_code=500, detail="YOLO model not loaded")
    
    try:
        start_time = time.time()
        
        # Decode image
        image = decode_base64_image(request["image"])
        
        # Run YOLO detection
        results = yolo_model(image)
        
        # Parse results
        detections = []
        annotated_image = image.copy()
        
        for *box, conf, cls in results.xyxy[0].cpu().numpy():
            if conf > 0.3:  # Confidence threshold
                x1, y1, x2, y2 = map(int, box)
                class_name = yolo_model.names[int(cls)]
                
                detections.append({
                    "class": class_name,
                    "confidence": float(conf),
                    "bbox": [x1, y1, x2, y2]
                })
                
                # Draw bounding box
                cv2.rectangle(annotated_image, (x1, y1), (x2, y2), (0, 255, 0), 2)
                cv2.putText(annotated_image, f"{class_name}: {conf:.2f}", 
                           (x1, y1-10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)
        
        processing_time = time.time() - start_time
        avg_confidence = np.mean([d["confidence"] for d in detections]) if detections else 0
        
        return {
            "detections": detections,
            "confidence": float(avg_confidence),
            "processing_time": processing_time,
            "annotated_image": encode_image_to_base64(annotated_image),
            "model_used": "best.pt"
        }
        
    except Exception as e:
        logger.error(f"YOLO detection error: {e}")
        raise HTTPException(status_code=500, detail=f"YOLO detection failed: {str(e)}")

@app.post("/roboflow-detect")
async def roboflow_detection(request: Dict[str, Any]):
    """Detect car damage using Roboflow model"""
    if roboflow_model is None:
        raise HTTPException(status_code=500, detail="Roboflow model not loaded")
    
    try:
        start_time = time.time()
        
        # Decode image
        image = decode_base64_image(request["image"])
        
        # Save temporary image for Roboflow
        temp_path = "temp_image.jpg"
        cv2.imwrite(temp_path, image)
        
        # Run Roboflow prediction
        prediction = roboflow_model.predict(temp_path, confidence=30, overlap=50)
        
        # Parse results
        detections = []
        annotated_image = image.copy()
        
        for pred in prediction.predictions:
            x1 = int(pred.x - pred.width/2)
            y1 = int(pred.y - pred.height/2)
            x2 = int(pred.x + pred.width/2)
            y2 = int(pred.y + pred.height/2)
            
            detections.append({
                "class": pred.class_name,
                "confidence": pred.confidence,
                "bbox": [x1, y1, x2, y2]
            })
            
            # Draw bounding box
            cv2.rectangle(annotated_image, (x1, y1), (x2, y2), (255, 0, 0), 2)
            cv2.putText(annotated_image, f"{pred.class_name}: {pred.confidence:.2f}", 
                       (x1, y1-10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 0, 0), 2)
        
        # Clean up temp file
        if os.path.exists(temp_path):
            os.remove(temp_path)
        
        processing_time = time.time() - start_time
        avg_confidence = np.mean([d["confidence"] for d in detections]) if detections else 0
        
        return {
            "detections": detections,
            "confidence": float(avg_confidence),
            "processing_time": processing_time,
            "annotated_image": encode_image_to_base64(annotated_image),
            "model_used": "roboflow"
        }
        
    except Exception as e:
        logger.error(f"Roboflow detection error: {e}")
        raise HTTPException(status_code=500, detail=f"Roboflow detection failed: {str(e)}")

@app.post("/damage-severity")
async def damage_severity_analysis(request: Dict[str, Any]):
    """Analyze damage severity using car-damage-model.h5"""
    if damage_severity_model is None:
        raise HTTPException(status_code=500, detail="Damage severity model not loaded")
    
    try:
        start_time = time.time()
        
        # Decode image
        image = decode_base64_image(request["image"])
        
        # Preprocess for damage severity model
        image_rgb = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
        image_resized = cv2.resize(image_rgb, (224, 224))  # Adjust based on your model
        image_normalized = image_resized / 255.0
        image_batch = np.expand_dims(image_normalized, axis=0)
        
        # Predict severity
        predictions = damage_severity_model.predict(image_batch, verbose=0)[0]
        
        # Define severity classes (adjust based on your model)
        severity_classes = ["minor", "moderate", "severe"]
        
        # Get the predicted severity
        severity_index = np.argmax(predictions)
        severity = severity_classes[severity_index] if severity_index < len(severity_classes) else "unknown"
        confidence = float(predictions[severity_index])
        
        processing_time = time.time() - start_time
        
        return {
            "severity": severity,
            "confidence": confidence,
            "all_predictions": {
                severity_classes[i]: float(predictions[i]) 
                for i in range(min(len(severity_classes), len(predictions)))
            },
            "processing_time": processing_time,
            "model_used": "car-damage-model.h5"
        }
        
    except Exception as e:
        logger.error(f"Damage severity analysis error: {e}")
        raise HTTPException(status_code=500, detail=f"Damage severity analysis failed: {str(e)}")

@app.post("/brand-detection")
async def brand_detection(request: Dict[str, Any]):
    """Detect car brand using Hugging Face model"""
    if car_brand_pipeline is None:
        raise HTTPException(status_code=500, detail="Car brand model not loaded")
    
    try:
        start_time = time.time()
        
        # Decode image
        image = decode_base64_image(request["image"])
        pil_image = Image.fromarray(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))
        
        # Run brand detection
        results = car_brand_pipeline(pil_image)
        
        # Get top prediction
        top_result = results[0] if results else {"label": "unknown", "score": 0.0}
        
        processing_time = time.time() - start_time
        
        return {
            "brand": top_result["label"],
            "confidence": top_result["score"],
            "all_predictions": [
                {"brand": r["label"], "confidence": r["score"]} 
                for r in results[:5]  # Top 5 predictions
            ],
            "processing_time": processing_time,
            "model_used": "dima806/car_brands_image_detection"
        }
        
    except Exception as e:
        logger.error(f"Brand detection error: {e}")
        raise HTTPException(status_code=500, detail=f"Brand detection failed: {str(e)}")

@app.post("/damage-type")
async def damage_type_detection(request: Dict[str, Any]):
    """Detect damage type using Hugging Face model"""
    if damage_type_pipeline is None:
        raise HTTPException(status_code=500, detail="Damage type model not loaded")
    
    try:
        start_time = time.time()
        
        # Decode image
        image = decode_base64_image(request["image"])
        pil_image = Image.fromarray(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))
        
        # Run damage type detection
        results = damage_type_pipeline(pil_image)
        
        # Filter results with confidence > 0.1
        filtered_results = [r for r in results if r["score"] > 0.1]
        
        processing_time = time.time() - start_time
        
        return {
            "damage_types": [
                {"type": r["label"], "confidence": r["score"]} 
                for r in filtered_results
            ],
            "primary_damage": filtered_results[0]["label"] if filtered_results else "no_damage",
            "processing_time": processing_time,
            "model_used": "beingamit99/car_damage_detection"
        }
        
    except Exception as e:
        logger.error(f"Damage type detection error: {e}")
        raise HTTPException(status_code=500, detail=f"Damage type detection failed: {str(e)}")

@app.post("/complete-analysis")
async def complete_analysis(request: Dict[str, Any]):
    """Run complete analysis using all models"""
    try:
        start_time = time.time()
        
        # Run all analyses
        ai_check = await check_ai_generated(request)
        
        # Only proceed if image is authentic
        if ai_check["is_ai_generated"]:
            return {
                "error": "AI-generated image detected",
                "ai_check": ai_check
            }
        
        # Run detection based on method
        method = request.get("method", "yolo")
        if method == "yolo":
            detection_result = await yolo_detection(request)
        else:
            detection_result = await roboflow_detection(request)
        
        # Run additional analyses
        brand_result = await brand_detection(request)
        damage_type_result = await damage_type_detection(request)
        severity_result = await damage_severity_analysis(request)
        
        total_time = time.time() - start_time
        
        return {
            "ai_check": ai_check,
            "detection": detection_result,
            "brand": brand_result,
            "damage_types": damage_type_result,
            "severity": severity_result,
            "total_processing_time": total_time
        }
        
    except Exception as e:
        logger.error(f"Complete analysis error: {e}")
        raise HTTPException(status_code=500, detail=f"Complete analysis failed: {str(e)}")

@app.get("/health")
async def health_check():
    """Health check endpoint"""
    return {
        "status": "healthy",
        "models_loaded": {
            "gnet": gnet_model is not None,
            "yolo": yolo_model is not None,
            "damage_severity": damage_severity_model is not None,
            "roboflow": roboflow_model is not None,
            "car_brand": car_brand_pipeline is not None,
            "damage_type": damage_type_pipeline is not None
        }
    }

if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=8000)


================================================================================
FILE: p2m/python-ai-service/requirements.txt
================================================================================
fastapi
uvicorn
opencv-python
torch
torchvision
tensorflow
pillow
numpy
ultralytics
roboflow
transformers
accelerate


================================================================================
FILE: p2m/tailwind.config.ts
================================================================================
import type { Config } from "tailwindcss";

const config: Config = {
    darkMode: ["class"],
    content: [
    "./pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./components/**/*.{js,ts,jsx,tsx,mdx}",
    "./app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
  	extend: {
  		colors: {
  			background: 'hsl(var(--background))',
  			foreground: 'hsl(var(--foreground))',
  			card: {
  				DEFAULT: 'hsl(var(--card))',
  				foreground: 'hsl(var(--card-foreground))'
  			},
  			popover: {
  				DEFAULT: 'hsl(var(--popover))',
  				foreground: 'hsl(var(--popover-foreground))'
  			},
  			primary: {
  				DEFAULT: 'hsl(var(--primary))',
  				foreground: 'hsl(var(--primary-foreground))'
  			},
  			secondary: {
  				DEFAULT: 'hsl(var(--secondary))',
  				foreground: 'hsl(var(--secondary-foreground))'
  			},
  			muted: {
  				DEFAULT: 'hsl(var(--muted))',
  				foreground: 'hsl(var(--muted-foreground))'
  			},
  			accent: {
  				DEFAULT: 'hsl(var(--accent))',
  				foreground: 'hsl(var(--accent-foreground))'
  			},
  			destructive: {
  				DEFAULT: 'hsl(var(--destructive))',
  				foreground: 'hsl(var(--destructive-foreground))'
  			},
  			border: 'hsl(var(--border))',
  			input: 'hsl(var(--input))',
  			ring: 'hsl(var(--ring))',
  			chart: {
  				'1': 'hsl(var(--chart-1))',
  				'2': 'hsl(var(--chart-2))',
  				'3': 'hsl(var(--chart-3))',
  				'4': 'hsl(var(--chart-4))',
  				'5': 'hsl(var(--chart-5))'
  			}
  		},
  		borderRadius: {
  			lg: 'var(--radius)',
  			md: 'calc(var(--radius) - 2px)',
  			sm: 'calc(var(--radius) - 4px)'
  		}
  	}
  },
  plugins: [require("tailwindcss-animate")],
};
export default config;


================================================================================
FILE: p2m/tsconfig.json
================================================================================
{
  "compilerOptions": {
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}

